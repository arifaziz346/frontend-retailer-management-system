import{r as g,j as _,l as z,c as l,a as t,b as d,u as y,n as b,y as C,F as D,q as j,o as i,t as c,s as W,g as L,f as $,w as A,B as N,e as q}from"./index-Bo1dTLXg.js";import{a as p}from"./axios-fk7X2WD2.js";import{f as R}from"./helper-B0BtwXvx.js";import{c as S}from"./stringHelpers-DhATn_QK.js";import{t as v}from"./toast-kIWbnzaY.js";import{_ as G}from"./BaseModal-ZxgzK4p7.js";import{_ as H}from"./Pagination-B_Rb_DdN.js";import{_ as h}from"./FormInput-CBrIbAuf.js";import{V as I}from"./vue-spinner-tail-Wj6EeOA1.js";import"./sweetalert2.esm.all-BQxta0Da.js";const J={key:0,class:"fixed inset-0 flex items-center justify-center bg-white/70 backdrop-blur-sm z-50"},K={class:"flex flex-col items-center space-y-3"},Q={key:1,class:"bg-white p-4 rounded shadow"},X={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between bg-white border-b border-gray-200 px-4 py-3 shadow-sm rounded-lg"},Y={class:"flex items-center space-x-2 text-sm md:text-base text-gray-600"},Z={class:"w-full overflow-x-scroll border border-gray-300 rounded-md shadow-sm"},tt={class:"flex flex-row justify-between items-center w-full bg bg-gray-800 text-white p-1"},et={key:0,class:"min-w-full border border-gray-200 bg-white rounded-xl overflow-hidden shadow-sm text-xs sm:text-sm md:text-base"},st={class:"px-4 py-2 text-gray-700"},ot={class:"px-4 py-2 text-gray-700"},at={class:"px-4 py-2 font-medium text-gray-900"},nt={class:"px-4 py-2 text-gray-700 text-center"},lt={class:"px-4 py-2 flex flex-col sm:flex-row justify-center gap-2"},it=["onClick"],rt=["onClick"],dt=["onClick"],ct={key:1,class:"flex flex-col items-center justify-center h-[60vh] text-center"},ut={class:"space-y-1"},pt={class:"flex gap-2"},mt=["value"],xt={key:0,class:"text-sm text-red-500"},ft={class:"flex flex-col justify-end mt-3"},gt={key:0,class:"text-sm text-red-500"},Lt={__name:"Transaction",setup(yt){const u=g(!1),m=g("Create Transaction"),x=g(!1),w=g(!1),n=_({transactions:[],accounts:[],pagination:{currentPage:1,nextPageUrl:null,prevPageUrl:null,lastPage:1},isLoading:!1}),o=_({id:"",account_id:"",transaction_type:"",amount:"",profit:"",description:"",transaction_date:""}),r=_({}),f=async(a="/transactions")=>{n.isLoading=!0;try{const e=await p.get(a);n.transactions=e.data.data.data,console.log(n.transactions),n.pagination=e.data.pagination}catch{v.error("Failed to load transactions")}finally{n.isLoading=!1}},B=async()=>{const a=await p.get("/transactions/accounts");n.accounts=a.data.data.data},U=()=>{k(),m.value="Create Transaction",x.value=!1,w.value=!1,u.value=!0},E=a=>{console.log("Editing transaction:",a),Object.assign(o,a),m.value="Edit Transaction",x.value=!1,w.value=!0,u.value=!0},F=async()=>{n.isLoading=!0;try{w.value?(await p.put(`/transactions/${o.id}`,o),v.success("Transaction updated")):(await p.post("/transactions",o),v.success("Transaction created")),u.value=!1,k(),f()}catch(a){Object.assign(r,a.response.data.errors||{})}finally{n.isLoading=!1}},M=async a=>{confirm("Are you sure?")&&(await p.delete(`/transactions/${a}`),v.success("Deleted successfully"),f())},k=()=>{Object.assign(o,{transaction_type:"",amount:"",profit:"",description:"",transaction_date:""}),Object.keys(r).forEach(a=>delete r[a])},O=a=>{Object.assign(o,a),console.log("Viewing transaction:",a),x.value=!0,m.value="View Transaction Detail",u.value=!0};return z(()=>{f(),B()}),(a,e)=>{const T=C("router-link"),P=C("Button");return n.isLoading?(i(),l("div",J,[t("div",K,[d(y(I),{size:"48px",color:"#2563eb"}),e[7]||(e[7]=t("p",{class:"text-blue-600 text-sm font-medium animate-pulse"}," Loading, please wait... ",-1))])])):(i(),l("div",Q,[t("header",X,[t("nav",Y,[d(T,{to:"/admin/transactions",class:"flex items-center hover:text-blue-600 transition-colors"},{default:b(()=>[...e[8]||(e[8]=[t("i",{class:"pi pi-money-bill mr-1 text-2xl"},null,-1),t("span",{class:"hidden sm:inline"},"Transaction",-1)])]),_:1})])]),t("div",Z,[t("div",tt,[e[10]||(e[10]=t("i",{class:"pi pi-money-bill mr-1 text-lg"}," Transaction List",-1)),d(P,{variant:"primary",size:"sm",class:"flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg shadow-sm transition-all duration-150 mt-3 sm:mt-0",onClick:e[0]||(e[0]=s=>U())},{default:b(()=>[...e[9]||(e[9]=[t("i",{class:"pi pi-plus text-sm"},null,-1),t("span",null,"Transaction",-1)])]),_:1})]),n.transactions&&n.transactions.length?(i(),l("table",et,[e[14]||(e[14]=t("thead",{class:"bg-gray-100 text-gray-700 text-xs"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left font-semibold"},"Transaction-Date"),t("th",{class:"px-4 py-2 text-left font-semibold"},"Account"),t("th",{class:"px-4 py-2 text-left font-semibold"},"Amount"),t("th",{class:"px-4 py-2 text-left font-semibold"},"Transaction-ype"),t("th",{class:"px-4 py-2 text-center font-semibold"},"Note"),t("th",{class:"px-4 py-2 text-center font-semibold"},"Action")])],-1)),t("tbody",null,[(i(!0),l(D,null,j(n.transactions,(s,bt)=>(i(),l("tr",{key:s.id,class:"border-t border-t-gray-300 hover:bg-gray-50 transition ext-sm text-xs"},[t("td",st,c(y(R)(s.transaction_date)||"-"),1),t("td",ot,c(s.account_name||"-"),1),t("td",at,"Rs."+c(s.amount||"-"),1),t("td",{class:W(`px-4 py-2 ${s.transaction_type==="Deposit"?"text-green-700 font-bold":"text-red-700 font-bold"}`)},c(s.transaction_type||"0"),3),t("td",nt,c(s.description||"-"),1),t("td",lt,[t("button",{onClick:V=>O(s),class:"flex flex-col sm:flex-row items-center gap-1 p-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-md shadow text-xs"},[...e[11]||(e[11]=[t("i",{class:"pi pi-eye text-base"},null,-1),t("span",null,"View",-1)])],8,it),t("button",{onClick:L(V=>E(s),["prevent"]),class:"flex flex-col sm:flex-row items-center gap-1 p-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md shadow text-xs"},[...e[12]||(e[12]=[t("i",{class:"pi pi-pencil text-base"},null,-1),t("span",null,"Edit",-1)])],8,rt),t("button",{onClick:L(V=>M(s.id),["prevent"]),class:"flex flex-col sm:flex-row items-center gap-1 p-2 bg-red-500 hover:bg-red-600 text-white rounded-md shadow text-xs"},[...e[13]||(e[13]=[t("i",{class:"pi pi-trash text-base"},null,-1),t("span",null,"Delete",-1)])],8,dt)])]))),128))])])):(i(),l("div",ct,[...e[15]||(e[15]=[t("img",{src:"https://cdn-icons-png.flaticon.com/512/4076/4076549.png",alt:"No Data",class:"w-32 h-32 opacity-70 mb-4"},null,-1),t("h2",{class:"text-xl font-semibold text-gray-700 mb-2"},"No Transaction Found",-1),t("p",{class:"text-gray-500"}," Try adding new transaction to see them listed here. ",-1)])])),d(H,{pagination:n.pagination,onPageChange:f},null,8,["pagination"])]),d(G,{modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=s=>u.value=s),title:m.value,onSave:F,disableSaveBtn:n.isLoading,"show-footer":x.value!=!0},{default:b(()=>[t("div",ut,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700"}," Select Account ",-1)),t("div",pt,[A(t("select",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.account_id=s),class:"w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500"},[e[16]||(e[16]=t("option",{value:""},"-- Select Account --",-1)),(i(!0),l(D,null,j(n.accounts||[],s=>(i(),l("option",{key:s.id,value:s.id},c(s.account_name),9,mt))),128))],512),[[N,o.account_id]]),d(T,{to:"/admin/accounts",class:"inline-block whitespace-nowrap rounded-md bg-blue-600 px-3 py-2 text-sm font-medium text-white hover:bg-blue-700 transition"},{default:b(()=>[...e[17]||(e[17]=[q(" + Account ",-1)])]),_:1})]),r?.account_id?(i(),l("p",xt,c(y(S)(r.account_id)),1)):$("",!0)]),d(h,{label:"Amount",modelValue:o.amount,"onUpdate:modelValue":e[2]||(e[2]=s=>o.amount=s),error:r.amount,type:"Number"},null,8,["modelValue","error"]),d(h,{label:"Transaction-Date",modelValue:o.transaction_date,"onUpdate:modelValue":e[3]||(e[3]=s=>o.transaction_date=s),error:r.transaction_date,type:"date"},null,8,["modelValue","error"]),d(h,{label:"Note",modelValue:o.description,"onUpdate:modelValue":e[4]||(e[4]=s=>o.description=s)},null,8,["modelValue"]),t("div",ft,[A(t("select",{"onUpdate:modelValue":e[5]||(e[5]=s=>o.transaction_type=s),class:"px-3 py-1 border border-gray-300 rounded bg-white text-black focus:outline-none focus:ring focus:ring-gray-300"},[...e[19]||(e[19]=[t("option",{disabled:"",value:""},"Select transaction type",-1),t("option",{value:"Withdraw"},"Withdraw",-1),t("option",{value:"Deposit"},"Deposit",-1),t("option",{value:"Failed"},"Failed",-1)])],512),[[N,o.transaction_type]]),r?.transaction_type?(i(),l("p",gt,c(y(S)(r.transaction_type)),1)):$("",!0)])]),_:1},8,["modelValue","title","disableSaveBtn","show-footer"])]))}}};export{Lt as default};
