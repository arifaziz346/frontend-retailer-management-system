import{r as g,k as h,m as O,c as n,a as t,b as c,u as f,q as k,z,f as C,B as M,t as r,F as V,x as T,e as v,o as i,y as S,h as j,w as R,C as W}from"./index-ZTB1Raef.js";import{a as u}from"./axios-CBe-jvwZ.js";import{f as q}from"./helper-B0BtwXvx.js";import{c as L}from"./stringHelpers-DhATn_QK.js";import{t as y}from"./toast-BWxgGeSH.js";import{_ as I}from"./BaseModal-D3tWCtYd.js";import{_ as Q}from"./Pagination-DD40CeHL.js";import{_ as $}from"./FormInput-DY9EFoZs.js";import{V as G}from"./vue-spinner-tail-CkTNzA0u.js";const H={key:0,class:"fixed inset-0 flex items-center justify-center bg-slate-900/10 backdrop-blur-md z-50"},J={class:"bg-white p-6 rounded-2xl shadow-xl flex flex-col items-center"},K={key:1,class:"min-h-screen bg-slate-50 pb-10"},X={class:"bg-white border-b border-slate-200 sticky top-0 z-30 shadow-sm"},Y={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex justify-between items-center"},Z={class:"flex items-center gap-3"},tt={class:"flex items-center text-sm font-semibold text-slate-400 tracking-tight"},et={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6 space-y-6"},st={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ot={class:"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm"},at={class:"text-xl font-black text-slate-800 mt-1"},lt={key:1,class:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden"},nt={class:"overflow-x-auto"},it={class:"w-full text-left border-collapse"},rt={class:"divide-y divide-slate-100"},dt={class:"px-6 py-4 text-sm text-slate-500"},ct={class:"px-6 py-4 font-bold text-slate-700 text-sm"},pt={class:"px-6 py-4 font-mono font-bold text-slate-900 text-sm"},ut={class:"px-6 py-4"},xt={class:"px-6 py-4 text-sm text-slate-500 max-w-[150px] truncate italic"},bt={class:"px-6 py-4 whitespace-nowrap"},mt={class:"flex justify-center gap-2"},gt=["onClick"],ft=["onClick"],vt=["onClick"],yt={class:"p-4 bg-slate-50/50 border-t border-slate-200"},wt={key:2,class:"flex flex-col items-center justify-center py-24 bg-white rounded-3xl border-2 border-dashed border-slate-200"},_t={class:"space-y-6 pt-2"},ht={class:"flex gap-2"},kt=["value"],Ct={key:0,class:"text-[11px] text-red-500 font-bold mt-1 ml-1"},Vt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Tt={class:"grid grid-cols-3 gap-2"},$t=["onClick"],At={key:0,class:"text-[11px] text-red-500 font-bold mt-1 ml-1"},Ot={__name:"Transaction",setup(Dt){const p=g(!1),x=g("Create Transaction"),b=g(!1),w=g(!1),a=h({transactions:[],accounts:[],pagination:{currentPage:1,nextPageUrl:null,prevPageUrl:null,lastPage:1},isLoading:!1}),l=h({id:"",account_id:"",transaction_type:"",amount:"",profit:"",description:"",transaction_date:""}),d=h({}),m=async(o="/transactions")=>{a.isLoading=!0;try{const e=await u.get(o);a.transactions=e.data.data.data,console.log(a.transactions),a.pagination=e.data.pagination}catch{y.error("Failed to load transactions")}finally{a.isLoading=!1}},E=async()=>{const o=await u.get("/transactions/accounts");a.accounts=o.data.data.data},A=()=>{D(),x.value="Create Transaction",b.value=!1,w.value=!1,p.value=!0},F=o=>{console.log("Editing transaction:",o),Object.assign(l,o),x.value="Edit Transaction",b.value=!1,w.value=!0,p.value=!0},P=async()=>{a.isLoading=!0;try{w.value?(await u.put(`/transactions/${l.id}`,l),y.success("Transaction updated")):(await u.post("/transactions",l),y.success("Transaction created")),p.value=!1,D(),m()}catch(o){Object.assign(d,o.response.data.errors||{})}finally{a.isLoading=!1}},U=async o=>{confirm("Are you sure?")&&(await u.delete(`/transactions/${o}`),y.success("Deleted successfully"),m())},D=()=>{Object.assign(l,{transaction_type:"",amount:"",profit:"",description:"",transaction_date:""}),Object.keys(d).forEach(o=>delete d[o])},B=o=>{Object.assign(l,o),console.log("Viewing transaction:",o),b.value=!0,x.value="View Transaction Detail",p.value=!0};return O(()=>{m(),E()}),(o,e)=>{const N=z("router-link");return a.isLoading?(i(),n("div",H,[t("div",J,[c(f(G),{size:"40px",color:"#2563eb"}),e[8]||(e[8]=t("p",{class:"text-blue-600 text-xs font-bold mt-4 tracking-widest uppercase"},"Processing",-1))])])):(i(),n("div",K,[t("header",X,[t("div",Y,[t("div",Z,[t("button",{onClick:e[0]||(e[0]=s=>o.$router.back()),class:"p-2 rounded-lg hover:bg-slate-100 transition active:scale-90"},[...e[9]||(e[9]=[t("i",{class:"pi pi-arrow-left text-slate-500"},null,-1)])]),t("nav",tt,[c(N,{to:"/admin/transactions",class:"hover:text-blue-600 transition flex items-center"},{default:k(()=>[...e[10]||(e[10]=[t("i",{class:"pi pi-money-bill mr-2"},null,-1),v(" Transactions ",-1)])]),_:1})])]),t("button",{onClick:e[1]||(e[1]=s=>A()),class:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 active:scale-95 text-white rounded-xl shadow-md transition-all font-bold text-sm"},[...e[11]||(e[11]=[t("i",{class:"pi pi-plus text-xs"},null,-1),t("span",null,"Add Transaction",-1)])])])]),t("div",et,[a.transactions?.length?(i(),n("div",st,[t("div",ot,[e[12]||(e[12]=t("p",{class:"text-slate-400 text-[10px] font-bold uppercase tracking-widest"},"Total Volume",-1)),t("p",at,r(a.transactions.length)+" Entries",1)]),e[13]||(e[13]=M('<div class="bg-white p-5 rounded-2xl border border-slate-200 shadow-sm"><p class="text-slate-400 text-[10px] font-bold uppercase tracking-widest">Active Filters</p><p class="text-xl font-black text-blue-600 mt-1">Current Page</p></div><div class="bg-blue-600 p-5 rounded-2xl shadow-lg shadow-blue-100 flex items-center justify-between"><div><p class="text-blue-100 text-[10px] font-bold uppercase tracking-widest">Quick Search</p><p class="text-white text-sm font-medium mt-1">Find by ID or Account</p></div><i class="pi pi-search text-blue-200 text-xl"></i></div>',2))])):C("",!0),a.transactions?.length?(i(),n("div",lt,[t("div",nt,[t("table",it,[e[18]||(e[18]=t("thead",{class:"bg-slate-50/50 border-b border-slate-200"},[t("tr",null,[t("th",{class:"px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widest"},"Date"),t("th",{class:"px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widest"},"Account"),t("th",{class:"px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widest"},"Amount"),t("th",{class:"px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widest"},"Type"),t("th",{class:"px-6 py-4 text-[11px] font-bold text-slate-500 uppercase tracking-widest"},"Note"),t("th",{class:"px-6 py-4 text-center text-[11px] font-bold text-slate-500 uppercase tracking-widest"},"Actions")])],-1)),t("tbody",rt,[(i(!0),n(V,null,T(a.transactions,s=>(i(),n("tr",{key:s.id,class:"hover:bg-blue-50/30 transition-colors group"},[t("td",dt,r(f(q)(s.transaction_date)),1),t("td",ct,r(s.account_name||"-"),1),t("td",pt,"Rs."+r(Number(s.amount).toLocaleString()),1),t("td",ut,[t("span",{class:S(["px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-wider inline-flex items-center gap-1",s.transaction_type==="Deposit"?"bg-green-100 text-green-700":s.transaction_type==="Withdraw"?"bg-blue-100 text-blue-700":"bg-red-100 text-red-700"])},[e[14]||(e[14]=t("span",{class:"w-1 h-1 rounded-full bg-current"},null,-1)),v(" "+r(s.transaction_type||"N/A"),1)],2)]),t("td",xt,r(s.description||"-"),1),t("td",bt,[t("div",mt,[t("button",{onClick:_=>B(s),class:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all"},[...e[15]||(e[15]=[t("i",{class:"pi pi-eye"},null,-1)])],8,gt),t("button",{onClick:j(_=>F(s),["prevent"]),class:"p-2 text-slate-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-all"},[...e[16]||(e[16]=[t("i",{class:"pi pi-pencil"},null,-1)])],8,ft),t("button",{onClick:j(_=>U(s.id),["prevent"]),class:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-all"},[...e[17]||(e[17]=[t("i",{class:"pi pi-trash"},null,-1)])],8,vt)])])]))),128))])])]),t("div",yt,[c(Q,{pagination:a.pagination,onPageChange:m},null,8,["pagination"])])])):(i(),n("div",wt,[e[20]||(e[20]=t("div",{class:"bg-slate-50 p-6 rounded-full mb-4"},[t("img",{src:"https://cdn-icons-png.flaticon.com/512/4076/4076549.png",class:"w-20 h-20 grayscale opacity-40"})],-1)),e[21]||(e[21]=t("h3",{class:"text-xl font-bold text-slate-800"},"Clean Slate",-1)),e[22]||(e[22]=t("p",{class:"text-slate-500 mb-6"},"No transactions found for the current period.",-1)),t("button",{onClick:e[2]||(e[2]=s=>A()),class:"text-blue-600 font-bold flex items-center gap-2 hover:underline"},[...e[19]||(e[19]=[t("i",{class:"pi pi-plus"},null,-1),v(" Add first transaction ",-1)])])]))]),c(I,{modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=s=>p.value=s),title:x.value,onSave:P,disableSaveBtn:a.isLoading,"show-footer":!b.value},{default:k(()=>[t("div",_t,[t("div",null,[e[25]||(e[25]=t("label",{class:"text-[11px] font-black text-slate-400 uppercase tracking-widest mb-2 block ml-1"},"Select Account",-1)),t("div",ht,[R(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>l.account_id=s),class:"w-full rounded-xl border border-slate-200 bg-slate-50 px-4 py-2.5 text-sm focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all"},[e[23]||(e[23]=t("option",{value:""},"Choose an account...",-1)),(i(!0),n(V,null,T(a.accounts,s=>(i(),n("option",{key:s.id,value:s.id},r(s.account_name),9,kt))),128))],512),[[W,l.account_id]]),c(N,{to:"/admin/accounts",class:"px-4 py-2.5 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-xl border border-slate-200 text-sm font-bold transition"},{default:k(()=>[...e[24]||(e[24]=[v(" + ",-1)])]),_:1})]),d?.account_id?(i(),n("p",Ct,r(f(L)(d.account_id)),1)):C("",!0)]),t("div",Vt,[c($,{label:"Amount",modelValue:l.amount,"onUpdate:modelValue":e[4]||(e[4]=s=>l.amount=s),error:d.amount,type:"Number",placeholder:"0.00"},null,8,["modelValue","error"]),c($,{label:"Date",modelValue:l.transaction_date,"onUpdate:modelValue":e[5]||(e[5]=s=>l.transaction_date=s),error:d.transaction_date,type:"date"},null,8,["modelValue","error"])]),t("div",null,[e[26]||(e[26]=t("label",{class:"text-[11px] font-black text-slate-400 uppercase tracking-widest mb-2 block ml-1"},"Type",-1)),t("div",Tt,[(i(),n(V,null,T(["Withdraw","Deposit","Failed"],s=>t("button",{key:s,type:"button",onClick:_=>l.transaction_type=s,class:S(["py-2 text-xs font-bold rounded-lg border transition-all",l.transaction_type===s?"bg-blue-600 border-blue-600 text-white shadow-md":"bg-white border-slate-200 text-slate-500 hover:border-slate-300"])},r(s),11,$t)),64))]),d?.transaction_type?(i(),n("p",At,r(f(L)(d.transaction_type)),1)):C("",!0)]),c($,{label:"Note / Reference",modelValue:l.description,"onUpdate:modelValue":e[6]||(e[6]=s=>l.description=s),placeholder:"Optional details..."},null,8,["modelValue"])])]),_:1},8,["modelValue","title","disableSaveBtn","show-footer"])]))}}};export{Ot as default};
