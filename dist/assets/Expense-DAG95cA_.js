import{r as x,k as v,s as F,m as L,c,f as w,a as e,b as r,u as M,e as R,t as u,w as C,v as P,F as U,x as q,q as G,i as H,o as m}from"./index-Ce5nBVLN.js";import{a as f}from"./axios-CBe-jvwZ.js";import{_ as I}from"./Pagination-DNKi8Txk.js";import{_ as $}from"./SelectOption-CXM6W3RT.js";import{_}from"./FormInput-lwy6tkXC.js";import{_ as J}from"./BaseModal-REScdjHD.js";import{V as K}from"./vue-spinner-tail-C5yLa_ls.js";import{t as h}from"./toast-BWxgGeSH.js";import{u as Q}from"./useFormErrors-BWkWHfi_.js";import"./stringHelpers-DhATn_QK.js";const W={key:0,class:"fixed inset-0 flex items-center justify-center bg-slate-900/10 backdrop-blur-md z-50"},X={class:"bg-white p-6 rounded-2xl shadow-xl flex flex-col items-center"},Y={class:"bg-slate-50 min-h-screen pb-12"},Z={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6 space-y-6"},ee={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},te={class:"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm flex flex-col justify-center"},se={class:"text-xl font-black text-slate-900 mt-1"},le={class:"bg-white p-4 rounded-2xl border border-slate-200 shadow-sm"},ae={class:"bg-white p-4 rounded-2xl border border-slate-200 shadow-sm"},oe={class:"bg-white p-4 rounded-2xl border border-slate-200 shadow-sm"},ne={class:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden"},re={class:"overflow-x-auto"},ie={class:"min-w-full divide-y divide-slate-200"},de={class:"divide-y divide-slate-100 bg-white"},pe={class:"px-6 py-4 whitespace-nowrap"},ue={class:"text-sm font-semibold text-slate-700 group-hover:text-blue-700 transition-colors"},xe={class:"px-6 py-4 whitespace-nowrap"},ce={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-600"},me={class:"px-6 py-4 whitespace-nowrap font-mono text-sm font-bold text-slate-900"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-slate-500"},fe={class:"px-6 py-4 whitespace-nowrap"},be={class:"flex justify-center items-center gap-3"},ve=["onClick"],_e=["onClick"],ye={key:0},we={key:0,class:"flex flex-col sm:flex-row justify-between items-center gap-4 bg-white p-4 rounded-2xl border border-slate-200 shadow-sm"},he={class:"text-xs font-medium text-slate-500 tracking-wide"},ke={class:"space-y-5 p-2"},Ve={class:"grid grid-cols-2 gap-4"},Ee={class:"flex items-end gap-2 w-full"},Ce={class:"flex-1"},ze={__name:"Expense",setup(Pe){const k=x(0),S=H(),d=x(!1),g=x(!1),b=x(!1),o=v({expenses:[],pagination:{currentPage:1,nextPageUrl:null,prevPageUrl:null,lastPage:1}}),V=x([]),y=x([]),n=v({expense_title:"",expense_category_id:"",from_date:"",to_date:""}),a=v({id:null,expense_title:"",expense_category_id:"",amount:"",expense_date:"",remark:""}),p=v({}),D=Q(p),i=async(l="/expenses")=>{d.value=!0;try{const s=(await f.get(l,{params:{...n}})).data.data;o.expenses=s.expenses.data,o.pagination.currentPage=s.expenses.current_page,o.pagination.lastPage=s.expenses.last_page,o.pagination.nextPageUrl=s.expenses.next_page_url,o.pagination.prevPageUrl=s.expenses.prev_page_url,k.value=s.total_expense_amount??0}catch(t){console.error("Expense fetch failed",t)}finally{d.value=!1}},j=async()=>{const l=await f.get("/expense-categories");V.value=l.data.data,y.value=V.value.map(t=>({label:t.category_name,value:t.id}))},A=async()=>{d.value=!0;try{const l={...a};delete l.category,b.value?(await f.put(`/expenses/${a.id}`,l),h.success("Expense updated")):(await f.post("/expenses",l),h.success("Expense created")),i(),E()}catch(l){D(l)}finally{d.value=!1}},N=()=>{E(),g.value=!0},T=l=>{Object.assign(a,l),a.expense_category_id=l.category?.id??l.expense_category_id??null,b.value=!0,g.value=!0},O=async l=>{try{if(!confirm("Delete this expense?"))return;await f.delete(`/expenses/${l}`),h.success("Expense deleted"),i(o.pagination.currentPage)}catch{}finally{d.value=!1}};F(()=>[n.from_date,n.to_date],()=>i());const E=()=>{Object.keys(a).forEach(l=>a[l]=""),a.id=null,b.value=!1,g.value=!1,Object.keys(p).forEach(l=>delete p[l])},B=()=>{S.push("expense-category")};return L(()=>{i(),j()}),(l,t)=>(m(),c(U,null,[d.value?(m(),c("div",W,[e("div",X,[r(M(K),{size:"40px",color:"#2563eb"}),t[13]||(t[13]=e("span",{class:"text-xs font-bold text-blue-600 mt-4 tracking-widest uppercase"},"Syncing",-1))])])):w("",!0),e("div",Y,[e("div",{class:"bg-white border-b border-slate-200 sticky top-0 z-30 shadow-sm"},[e("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex justify-between items-center"},[t[15]||(t[15]=e("div",{class:"flex items-center gap-2"},[e("div",{class:"bg-blue-600 p-2 rounded-lg"},[e("i",{class:"pi pi-tags text-white text-sm"})]),e("h2",{class:"text-xl font-extrabold text-slate-800 tracking-tight"},"Expenses")],-1)),e("button",{onClick:N,class:"flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 active:scale-95 text-white rounded-xl shadow-md shadow-blue-200 transition-all font-semibold text-sm"},[...t[14]||(t[14]=[e("i",{class:"pi pi-plus text-xs"},null,-1),e("span",null,"Add Expense",-1)])])])]),e("div",Z,[e("div",ee,[e("div",te,[t[17]||(t[17]=e("p",{class:"text-slate-500 text-[10px] font-bold uppercase tracking-wider"},"Total Expense",-1)),e("p",se,[t[16]||(t[16]=e("span",{class:"text-blue-600 text-sm font-bold"},"Rs.",-1)),R(" "+u(k.value.toLocaleString()),1)])]),e("div",le,[t[18]||(t[18]=e("label",{class:"text-[10px] font-bold text-slate-400 uppercase ml-1"},"Category",-1)),r($,{modelValue:n.expense_category_id,"onUpdate:modelValue":[t[0]||(t[0]=s=>n.expense_category_id=s),t[1]||(t[1]=s=>i())],list:y.value,placeholder:"All Categories"},null,8,["modelValue","list"])]),e("div",ae,[t[19]||(t[19]=e("label",{class:"text-[10px] font-bold text-slate-400 uppercase ml-1"},"From Date",-1)),C(e("input",{type:"date","onUpdate:modelValue":t[2]||(t[2]=s=>n.from_date=s),onChange:t[3]||(t[3]=s=>i()),class:"w-full mt-1 text-sm border-none focus:ring-0 text-slate-700 bg-transparent cursor-pointer"},null,544),[[P,n.from_date]])]),e("div",oe,[t[20]||(t[20]=e("label",{class:"text-[10px] font-bold text-slate-400 uppercase ml-1"},"To Date",-1)),C(e("input",{type:"date","onUpdate:modelValue":t[4]||(t[4]=s=>n.to_date=s),onChange:t[5]||(t[5]=s=>i()),class:"w-full mt-1 text-sm border-none focus:ring-0 text-slate-700 bg-transparent cursor-pointer"},null,544),[[P,n.to_date]])])]),e("div",ne,[e("div",re,[e("table",ie,[t[24]||(t[24]=e("thead",{class:"bg-slate-50"},[e("tr",null,[e("th",{class:"px-6 py-4 text-left text-[11px] font-bold text-slate-500 uppercase tracking-widest"},"Title"),e("th",{class:"px-6 py-4 text-left text-[11px] font-bold text-slate-500 uppercase tracking-widest"},"Category"),e("th",{class:"px-6 py-4 text-left text-[11px] font-bold text-slate-500 uppercase tracking-widest"},"Amount"),e("th",{class:"px-6 py-4 text-left text-[11px] font-bold text-slate-500 uppercase tracking-widest"},"Date"),e("th",{class:"px-6 py-4 text-center text-[11px] font-bold text-slate-500 uppercase tracking-widest"},"Actions")])],-1)),e("tbody",de,[(m(!0),c(U,null,q(o.expenses,s=>(m(),c("tr",{key:s.id,class:"hover:bg-blue-50/40 transition-colors group"},[e("td",pe,[e("span",ue,u(s.expense_title),1)]),e("td",xe,[e("span",ce,u(s.category?.category_name||"Uncategorized"),1)]),e("td",me," Rs. "+u(Number(s.amount).toLocaleString()),1),e("td",ge,u(s.expense_date),1),e("td",fe,[e("div",be,[e("button",{onClick:z=>T(s),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit"},[...t[21]||(t[21]=[e("i",{class:"pi pi-pencil text-sm"},null,-1)])],8,ve),e("button",{onClick:z=>O(s.id),class:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Delete"},[...t[22]||(t[22]=[e("i",{class:"pi pi-trash text-sm"},null,-1)])],8,_e)])])]))),128)),o.expenses.length?w("",!0):(m(),c("tr",ye,[...t[23]||(t[23]=[e("td",{colspan:"5",class:"py-20 text-center"},[e("div",{class:"flex flex-col items-center"},[e("div",{class:"bg-slate-100 p-4 rounded-full mb-4"},[e("i",{class:"pi pi-folder-open text-slate-400 text-3xl"})]),e("p",{class:"text-slate-500 font-medium"},"No expenses found for this selection")])],-1)])]))])])])]),o.pagination.lastPage>1?(m(),c("div",we,[e("p",he," Page "+u(o.pagination.currentPage)+" of "+u(o.pagination.lastPage),1),r(I,{pagination:o.pagination,onPageChange:i},null,8,["pagination"])])):w("",!0)]),r(J,{modelValue:g.value,"onUpdate:modelValue":t[12]||(t[12]=s=>g.value=s),title:b.value?"Edit Expense":"New Expense Entry",onSave:A,disableSaveBtn:d.value},{default:G(()=>[e("div",ke,[r(_,{label:"Expense Title",placeholder:"e.g. Office Supplies",modelValue:a.expense_title,"onUpdate:modelValue":t[6]||(t[6]=s=>a.expense_title=s),error:p.expense_title},null,8,["modelValue","error"]),e("div",Ve,[r(_,{label:"Amount",type:"number",modelValue:a.amount,"onUpdate:modelValue":t[7]||(t[7]=s=>a.amount=s),error:p.amount},null,8,["modelValue","error"]),r(_,{label:"Transaction Date",type:"date",modelValue:a.expense_date,"onUpdate:modelValue":t[8]||(t[8]=s=>a.expense_date=s),error:p.expense_date},null,8,["modelValue","error"])]),e("div",Ee,[e("div",Ce,[r($,{modelValue:a.expense_category_id,"onUpdate:modelValue":t[9]||(t[9]=s=>a.expense_category_id=s),list:y.value,label:"Select Category",error:p.expense_category_id},null,8,["modelValue","list","error"])]),e("button",{class:"p-2 text-sm bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-lg border border-slate-300 transition-colors",onClick:t[10]||(t[10]=s=>B()),title:"Add New Category"},[...t[25]||(t[25]=[e("i",{class:"pi pi-plus"}," Category",-1)])])]),r(_,{label:"Remark (Optional)",placeholder:"Add extra details here...",modelValue:a.remark,"onUpdate:modelValue":t[11]||(t[11]=s=>a.remark=s)},null,8,["modelValue"])])]),_:1},8,["modelValue","title","disableSaveBtn"])])],64))}};export{ze as default};
