import{a as p}from"./axios-CBe-jvwZ.js";import{_ as A}from"./Button-DD9NRzX2.js";import{z as S,c,o as m,a as s,F as U,x as L,t as $,f as V,b as u,e as D,r as g,k as v,m as M,u as T,q as E,i as q}from"./index-ZTB1Raef.js";import{_ as R}from"./BaseModal-D3tWCtYd.js";import{_ as G}from"./FormInput-DY9EFoZs.js";import{u as H}from"./useFormErrors-BWkWHfi_.js";import{B as J}from"./BackButton-NIMBK3Oo.js";import{V as K}from"./vue-spinner-tail-CkTNzA0u.js";import{t as h}from"./toast-BWxgGeSH.js";import"./stringHelpers-DhATn_QK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"overflow-x-auto w-full"},P={class:"min-w-full bg-white shadow-md rounded-lg overflow-hidden"},Q={class:"p-3 text-sm text-gray-700"},W={class:"p-3 text-sm font-medium text-gray-800"},X={class:"p-3 text-sm flex justify-center gap-4"},Y=["onClick"],Z=["onClick"],ee={__name:"CategoryTable",props:{categories:{type:Array,required:!0}},emits:["view","delete","edit"],setup(w){return(a,r)=>{const n=S("Icon");return m(),c("div",O,[s("table",P,[r[2]||(r[2]=s("thead",null,[s("tr",{class:"bg-gray-100 text-left text-gray-700 text-sm uppercase"},[s("th",{class:"p-3"},"#"),s("th",{class:"p-3"},"Category Name"),s("th",{class:"p-3 text-center"},"Actions")])],-1)),s("tbody",null,[(m(!0),c(U,null,L(w.categories,(l,y)=>(m(),c("tr",{key:l.id,class:"border-b border-b-gray-200 hover:bg-gray-50"},[s("td",Q,$(y+1),1),s("td",W,$(l.category_name),1),s("td",X,[l.id!==1?(m(),c("button",{key:0,class:"text-blue-600 hover:text-blue-800 flex items-center",onClick:i=>a.$emit("edit",l)},[u(n,{name:"mdi:pencil",class:"w-4 h-4 mr-1"}),r[0]||(r[0]=D(" Edit ",-1))],8,Y)):V("",!0),l.id!==1?(m(),c("button",{key:1,class:"text-red-600 hover:text-red-800 flex items-center",onClick:i=>a.$emit("delete",l.id)},[u(n,{name:"mdi:delete",class:"w-4 h-4 mr-1"}),r[1]||(r[1]=D(" Delete ",-1))],8,Z)):V("",!0)])]))),128))])])])}}},te={key:0,class:"fixed inset-0 flex items-center justify-center bg-white/70 backdrop-blur-sm z-50"},se={class:"flex flex-col items-center space-y-3"},oe={key:1,class:"flex flex-col min-h-screen bg-gray-50 overflow-x-hidden"},ae={class:"bg-white shadow-sm px-4 sm:px-6 py-3 sm:py-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3"},re={key:0},ne={class:"flex flex-row gap-4 p-4 sm:p-6 max-w-7xl mx-auto w-full"},le={key:1,class:"flex flex-col items-center justify-center h-[60vh] text-center"},ie={class:"p-6 bg-white border-slate-200"},ce={class:"bg-white p-4 rounded-lg shadow-2xl"},we={__name:"Category",setup(w){const a=g(!1),r=g(!1),n=g(!1);g("");const l=g(null);g(null);const y=q(),i=v({categories:[]}),d=v({category_name:""}),x=v({category_name:""}),b=H(x),F=()=>{n.value=!0,k()},C=async()=>{a.value=!0;try{const e=await p.get("/categories");i.categories=e.data.categories,console.log("Fetched categories:",e)}catch(e){console.error("Error fetching categories:",e)}finally{a.value=!1}},N=async()=>{console.log("Creating Category Start"),a.value=!0;try{console.log("After try");const e=new FormData;e.append("category_name",d.category_name);const o=(await p.post("/categories",e)).data;o.success&&(h.success(o.message),n.value=!1,C())}catch(e){console.log("creating categorie",e),b(e)}finally{a.value=!1}},B=async()=>{a.value=!0;try{new FormData().append("category_name",d.category_name);const o=(await p.put(`/categories/${l.value}`,{category_name:d.category_name})).data;if(o.success){h.success(o.message);const f=i.categories.findIndex(_=>_.id===l.value);f!==-1&&(i.categories[f]=o.category),n.value=!1,d.category_name=""}}catch(e){console.error("Update Error:",e),b(e)}finally{a.value=!1}},j=async e=>{a.value=!0;try{const o=(await p.delete(`/categories/${e}`)).data;if(o.success){h.success(o.message);const f=i.categories.findIndex(_=>_.id===e);f!==-1&&i.categories.splice(f,1)}n.value=!1}catch(t){console.error("Error deleting category:",t)}finally{a.value=!1}},I=e=>{k(),n.value=!0,d.category_name=e.category_name,r.value=!0,l.value=e.id},k=()=>{d.category_name="",x.category_name=""},z=e=>{const t=e.id;y.push({name:"admin.products",params:{id:t,category_name:e.category_name}})};return M(()=>{C()}),(e,t)=>a.value?(m(),c("div",te,[s("div",se,[u(T(K),{size:"48px",color:"#2563eb"}),t[4]||(t[4]=s("p",{class:"text-blue-600 text-sm font-medium animate-pulse"}," Loading, please wait... ",-1))])])):(m(),c("div",oe,[s("header",ae,[u(J),t[6]||(t[6]=s("h1",{class:"text-xl sm:text-2xl font-semibold text-gray-800 tracking-tight"}," Item Categories ",-1)),u(A,{variant:"primary",size:"sm",class:"flex items-center justify-center gap-2",onClick:t[0]||(t[0]=()=>{r.value=!1,F()})},{default:E(()=>[...t[5]||(t[5]=[s("i",{class:"pi pi-plus text-sm"}," Category",-1)])]),_:1})]),i.categories&&i.categories.length?(m(),c("div",re,[s("main",ne,[u(ee,{categories:i.categories,onView:z,onDelete:j,onEdit:I},null,8,["categories"])])])):(m(),c("div",le,[...t[7]||(t[7]=[s("img",{src:"https://cdn-icons-png.flaticon.com/512/4076/4076549.png",alt:"No Data",class:"w-32 h-32 opacity-70 mb-4"},null,-1),s("h2",{class:"text-xl font-semibold text-gray-700 mb-2"}," No Category Found ",-1),s("p",{class:"text-gray-500"}," Try adding new products to see them listed here. ",-1)])])),s("div",ie,[u(R,{modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=o=>n.value=o),title:r.value?"Edit Category":"Create Category",onSave:t[3]||(t[3]=()=>r.value?B():N())},{default:E(()=>[s("div",ce,[u(G,{id:"name",label:"Name",modelValue:d.category_name,"onUpdate:modelValue":t[1]||(t[1]=o=>d.category_name=o),error:x.category_name},null,8,["modelValue","error"])])]),_:1},8,["modelValue","title"])])]))}};export{we as default};
