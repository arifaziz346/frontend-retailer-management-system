import{a as w}from"./axios-pwxHYZIu.js";import{_ as Q}from"./Button-D7xYEVP1.js";import{k as W,c as n,o as i,f as C,a as e,t as u,F as S,q as $,u as V,H as M,I as T,w as A,B as z,r as b,v as X,j as P,l as Y,z as Z,b as x,n as j,y as ee,h as te,e as se}from"./index-DppJ4uJc.js";import{V as D}from"./vue-spinner-tail-D8qEx31J.js";import{_ as oe}from"./BaseModal-DaTHTPvo.js";import{_ as B}from"./FormInput-DqkHBGkx.js";import{c as ae}from"./stringHelpers-DhATn_QK.js";import{_ as le}from"./Pagination-hmH0ImhT.js";import{t as E}from"./toast-kIWbnzaY.js";import{u as re}from"./useFormErrors-BWkWHfi_.js";import{r as ne,p as ie}from"./helper-B0BtwXvx.js";import"./lodash-DjYotaSc.js";import"./sweetalert2.esm.all-BQxta0Da.js";const de={class:"flex flex-col"},ce=["for"],ue=["id","value","disabled"],me={key:0,value:""},pe=["value"],ge={key:1,class:"text-red-600 text-sm mt-1"},fe={__name:"Selector",props:{id:String,label:String,modelValue:[String,Number],options:{type:[Array,Object],required:!0},placeholder:{type:String,default:""},error:String,disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(d,{emit:_}){const f=d,a=_,p=W(()=>Array.isArray(f.options)?f.options.map(o=>typeof o=="object"?{label:o.label??o.name??o.value,value:o.value??o.id??o.label}:{label:o,value:o}):Object.entries(f.options).map(([o,v])=>({label:v,value:o}))),m=o=>{a("update:modelValue",o.target.value)};return(o,v)=>(i(),n("div",de,[d.label?(i(),n("label",{key:0,for:d.id,class:"text-xs lg:text-sm font-medium mb-1"},u(d.label),9,ce)):C("",!0),e("select",{id:d.id,value:d.modelValue,disabled:d.disabled,onChange:m,class:"placeholder:italic placeholder:text-slate-400 block bg-white w-full border border-slate-300 rounded-md py-1.5 pl-3 pr-10 shadow-sm focus:outline-none focus:border-sky-500 focus:ring-sky-500 focus:ring-1 sm:text-sm"},[d.placeholder?(i(),n("option",me,u(d.placeholder),1)):C("",!0),(i(!0),n(S,null,$(p.value,(c,g)=>(i(),n("option",{key:g,value:c.value},u(c.label),9,pe))),128))],40,ue),d.error?(i(),n("p",ge,u(V(ae)(d.error)),1)):C("",!0)]))}},ye={class:"flex items-start gap-2 w-full"},xe={class:"flex-1 min-w-0"},be={class:"block text-sm font-medium mb-1"},_e={class:"relative w-auto"},ve=["value"],he={__name:"TypeSelector",props:M({label:{type:String,default:"Select"},sub_categories:{type:Array,default:()=>[]},error:String,button_name:{type:String,default:"Add"},show_button:{type:Boolean,default:!0}},{modelValue:{default:"other"},modelModifiers:{}}),emits:M(["click_sub_category"],["update:modelValue"]),setup(d,{emit:_}){const f=T(d,"modelValue"),a=_;return(p,m)=>(i(),n("div",ye,[e("div",xe,[e("label",be,u(d.label),1),e("div",_e,[A(e("select",{"onUpdate:modelValue":m[0]||(m[0]=o=>f.value=o),class:"placeholder:italic placeholder:text-slate-400 block bg-white w-full border border-slate-300 rounded-md py-1.5 pl-3 pr-10 shadow-sm focus:outline-none focus:border-sky-500 focus:ring-sky-500 focus:ring-1 sm:text-sm"},[m[2]||(m[2]=e("option",{value:"other"},"Other",-1)),(i(!0),n(S,null,$(d.sub_categories,o=>(i(),n("option",{key:o.id,value:o.id},u(o.category_name),9,ve))),128))],512),[[z,f.value]])])]),d.show_button?(i(),n("button",{key:0,class:"mt-6 bg-green-600 hover:bg-green-700 text-white px-4 py-1.5 rounded-md shadow-sm border border-green-700",onClick:m[1]||(m[1]=o=>a("click_sub_category"))},u(d.button_name),1)):C("",!0)]))}},we={class:"flex flex-row justify-between sm:flex-row items-center gap-1 w-full"},ke={class:"w-1/8"},Ve=["value"],Ce={class:"relative w-full sm:w-1/4"},Se={key:0,class:"pi pi-search absolute right-3 bottom-2.5 text-gray-400"},$e={__name:"FilterBar",props:{subCategories:{type:Array,default:()=>[]},showButton:{type:Boolean,default:!0}},emits:["update:search","update:category_id","click_add_category"],setup(d,{emit:_}){const f=_,a=b(""),p=b(""),m=()=>{f("update:search",a.value),f("update:category_id",p.value)},o=()=>{a.value="",m()};return(v,c)=>(i(),n("div",we,[e("div",ke,[A(e("select",{"onUpdate:modelValue":c[0]||(c[0]=g=>p.value=g),onChange:m,class:"placeholder:italic placeholder:text-slate-400 block bg-white w-full border border-slate-300 rounded-md py-1.5 pl- pr-10 shadow-sm focus:outline-none focus:border-sky-500 focus:ring-sky-500 focus:ring-1 sm:text-sm"},[c[2]||(c[2]=e("option",{value:""},"All Categories",-1)),(i(!0),n(S,null,$(d.subCategories,g=>(i(),n("option",{key:g.id,value:g.id},u(g.category_name),9,Ve))),128))],544),[[z,p.value]])]),e("div",Ce,[A(e("input",{"onUpdate:modelValue":c[1]||(c[1]=g=>a.value=g),onInput:m,type:"text",placeholder:"Search Item...",class:"placeholder:italic placeholder:text-slate-400 block bg-white w-full border border-slate-300 rounded-md py-1.5 pl-3 pr-10 shadow-sm focus:outline-none focus:border-sky-500 focus:ring-sky-500 focus:ring-1 sm:text-sm"},null,544),[[X,a.value]]),a.value?(i(),n("i",{key:1,onClick:o,class:"pi pi-times absolute right-3 bottom-2.5 text-gray-400 cursor-pointer"})):(i(),n("i",Se))])]))}},Ue={key:0,class:"fixed inset-0 flex items-center justify-center bg-white/70 backdrop-blur-sm z-50"},Ie={class:"flex flex-col items-center space-y-3"},Pe={key:1,class:"flex flex-col min-h-screen bg-gray-50 overflow-x-hidden"},je={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between bg-white border-b border-gray-200 px-4 py-3 shadow-sm rounded-lg"},Be={class:"flex items-center space-x-2 text-sm md:text-base text-gray-600"},Ee={class:"font-semibold text-gray-900"},Ae={class:"flex-1 p-4 sm:p-6 md:p-8"},Fe={class:"flex flex-row justify-between"},Ne={key:0,class:"flex items-center justify-center p-4"},Me={key:1},De={key:0,class:"w-full overflow-x-auto border border-gray-300 rounded-md shadow-sm mt-1"},Te={class:"min-w-full border border-gray-200 bg-white rounded-xl overflow-hidden shadow-sm text-xs sm:text-sm md:text-base"},ze={class:"px-4 py-2 font-medium text-gray-800"},Oe={class:"px-4 py-2 text-gray-700"},Le={class:"px-4 py-2 font-medium text-gray-900"},Re={class:"px-4 py-2 text-gray-700"},qe={class:"px-4 py-2 text-gray-700"},He={class:"px-4 py-2 text-gray-700"},Ge={class:"px-4 py-2 text-gray-700"},Je={class:"px-4 py-2 text-gray-700"},Ke={class:"px-4 py-2 text-gray-700"},Qe={class:"px-4 py-2 text-gray-700"},We={class:"px-4 py-2 flex flex-col sm:flex-row justify-center gap-2"},Xe=["onClick"],Ye=["onClick"],Ze={key:1,class:"flex flex-col items-center justify-center h-[60vh] text-center"},et={class:"bg-white p-4 rounded-lg shadow-2xl space-y-2"},tt={class:"flex items-center gap-2"},st={class:"flex-1"},yt={__name:"Item",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(d){const _=Z(),f=te();T(d,"modelValue");const a=P({items:[],units:[],categories:[],pagination:{currentPage:1,nextPageUrl:null,prevPageUrl:null,lastPage:1}}),p=b(),m=b(),o=b(!1),v=b(!1),c=b(!1),g=b(""),k=b(!1),U=b(""),r=P({name:"",category_id:p.value,sale_price:"",cost_price:"",stock:"",unit:""}),h=P({name:"",sale_price:"",category_id:"",cost_price:"",unit:""}),O=re(h),L=()=>{f.push("/admin/unit")},I=async(l="/items")=>{try{v.value?v.value=!0:o.value=!0;const y=(await w.get(l,{params:{search:U.value||null,category_id:p.value||null}})).data.data;a.items=y.data,a.pagination.currentPage=y.current_page,a.pagination.lastPage=y.last_page,a.pagination.nextPageUrl=y.next_page_url,a.pagination.prevPageUrl=y.prev_page_url}catch(t){console.log("Error fetching items:",t)}finally{o.value=!1,v.value=!1}},R=async()=>{try{const l=await w.get("/categories");a.categories=l.data.categories}catch(l){console.log("Error fetching categories:",l)}},F=()=>{r.name="",r.sale_price="",r.cost_price="",r.unit="",r.category_id=p.value||0,Object.keys(h).forEach(l=>h[l]=""),k.value=!1,c.value=!1,g.value=""},q=l=>{c.value=!0,g.value=l.id,r.name=l.name,r.sale_price=l.sale_price,r.cost_price=l.cost_price,r.unit=l.unit,r.category_id=l.category_id,k.value=!0},N=async()=>{o.value=!0;try{const l={name:r.name,sale_price:r.sale_price,cost_price:r.cost_price,unit:r.unit,category_id:r.category_id};let t;if(c.value?t=await w.put(`/items/${g.value}`,l):t=await w.post("/items",l),!c.value)a.items.unshift(t.data.item);else{const y=a.items.findIndex(s=>s.id===g.value);y!==-1&&(a.items[y]=t.data.item)}t.data.success&&(I(),E.success(t.data.message||(c.value?"Item updated successfully":"Item created successfully")),F())}catch(l){console.error("Error saving/updating item:",l),O(l)}finally{o.value=!1}},H=async l=>{if(confirm("Are you sure you want to delete this item?")){o.value=!0;try{const t=await w.delete(`/items/${l}`);a.items=a.items.filter(y=>y.id!==l),t.data.success&&E.success(t.data.message||(c.value?"Item updated successfully":"Item created successfully"))}catch(t){console.error("Error deleting item:",t),E.error("Failed to delete item")}finally{o.value=!1}}},G=()=>{f.push("/admin/category")},J=async()=>{try{const l=await w.get("/units");a.units=l.data.data,console.log("Units fetched:",a.units)}catch(l){console.log("Error fetching units:",l)}};return Y(async()=>{p.value=_.params.id||0,m.value=_.params.category_name||"",r.category_id=p.value,await I(),await R(),await J()}),(l,t)=>{const y=ee("router-link");return o.value?(i(),n("div",Ue,[e("div",Ie,[x(V(D),{size:"48px",color:"#2563eb"}),t[10]||(t[10]=e("p",{class:"text-blue-600 text-sm font-medium animate-pulse"}," Loading, please wait... ",-1))])])):(i(),n("div",Pe,[e("header",je,[e("nav",Be,[x(y,{to:"/admin/Item",class:"flex items-center hover:text-blue-600 transition-colors"},{default:j(()=>[...t[11]||(t[11]=[e("i",{class:"pi pi-home mr-1 text-2xl"},null,-1),e("span",{class:"hidden sm:inline"},"Items",-1)])]),_:1}),e("span",Ee,u(m.value),1)]),x(Q,{variant:"primary",size:"sm",class:"flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg shadow-sm transition-all duration-150 mt-3 sm:mt-0",onClick:t[0]||(t[0]=()=>{F(),c.value=!1,k.value=!0,l.addVariant()})},{default:j(()=>[...t[12]||(t[12]=[e("i",{class:"pi pi-plus text-sm"},null,-1),e("span",null,"Items",-1)])]),_:1})]),e("main",Ae,[e("div",Fe,[x($e,{subCategories:a.categories,search:U.value,"onUpdate:search":t[1]||(t[1]=s=>U.value=s),category_id:p.value,"onUpdate:category_id":t[2]||(t[2]=s=>p.value=s),showButton:!1},null,8,["subCategories","search","category_id"])]),v.value?(i(),n("div",Ne,[x(V(D),{size:"32px",color:"#2563eb"}),t[13]||(t[13]=e("span",{class:"ml-2 text-blue-600 font-medium animate-pulse"},"Searching...",-1))])):(i(),n("div",Me,[a.items&&a.items.length?(i(),n("div",De,[t[15]||(t[15]=e("div",{class:"w-full bg-gray-800 text-white p-1.5"},[e("i",{class:"pi pi-home mr-1 text-md"}," Item List")],-1)),e("table",Te,[t[14]||(t[14]=e("thead",{class:"bg-gray-100 text-gray-700 text-sm"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left font-semibold"},"#ID"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Bar-Code"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Item-Name"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Category"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Cost Price"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Sale Price"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Profit"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Profit%"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Unit"),e("th",{class:"px-4 py-2 text-left font-semibold"},"In-Stock"),e("th",{class:"px-4 py-2 text-center font-semibold"},"Actions")])],-1)),e("tbody",null,[(i(!0),n(S,null,$(a.items,s=>(i(),n("tr",{key:s.id,class:"border-t border-t-gray-200 hover:bg-gray-50 transition ext-sm"},[e("td",ze,u(s.id),1),e("td",Oe,u(s.unique_barcode),1),e("td",Le,u(s.name),1),e("td",Re,u(s.category&&s.category.category_name?s.category.category_name:"-"),1),e("td",qe,"Rs."+u(s.cost_price),1),e("td",He,"Rs."+u(s.sale_price),1),e("td",Ge,"Rs."+u(V(ne)(s.sale_price-s.cost_price)),1),e("td",Je,u(V(ie)(s.sale_price,s.cost_price)),1),e("td",Ke,u(s.unit||"-"),1),e("td",Qe,u(s.quantity_in_stock||"0"),1),e("td",We,[e("button",{onClick:K=>q(s),class:"px-3 py-1.5 text-xs sm:text-sm md:text-base text-white bg-blue-600 hover:bg-blue-700 rounded-md shadow"}," Edit ",8,Xe),e("button",{onClick:K=>H(s.id),class:"px-3 py-1.5 text-xs sm:text-sm md:text-base text-white bg-red-500 hover:bg-red-600 rounded-md shadow"}," Delete ",8,Ye)])]))),128))])]),x(le,{pagination:a.pagination,onPageChange:I},null,8,["pagination"])])):(i(),n("div",Ze,[...t[16]||(t[16]=[e("img",{src:"https://cdn-icons-png.flaticon.com/512/4076/4076549.png",alt:"No Data",class:"w-32 h-32 opacity-70 mb-4"},null,-1),e("h2",{class:"text-xl font-semibold text-gray-700 mb-2"},"No Products Found",-1),e("p",{class:"text-gray-500"}," Try adding new products to see them listed here. ",-1)])]))]))]),x(oe,{modelValue:k.value,"onUpdate:modelValue":t[8]||(t[8]=s=>k.value=s),title:c.value?"Edit Item":"Create Item",onSave:t[9]||(t[9]=()=>(c.value,N())),disableSaveBtn:o.value},{default:j(()=>[e("div",et,[x(B,{id:"name",label:"Name",modelValue:r.name,"onUpdate:modelValue":t[3]||(t[3]=s=>r.name=s),error:h.name},null,8,["modelValue","error"]),x(he,{modelValue:r.category_id,"onUpdate:modelValue":t[4]||(t[4]=s=>r.category_id=s),sub_categories:a.categories||[],error:h?.category_id,button_name:"+ Category",label:"Select-Category",onClick_sub_category:G},null,8,["modelValue","sub_categories","error"]),x(B,{modelValue:r.cost_price,"onUpdate:modelValue":t[5]||(t[5]=s=>r.cost_price=s),label:"Buy Price",error:h.cost_price,type:"number"},null,8,["modelValue","error"]),x(B,{modelValue:r.sale_price,"onUpdate:modelValue":t[6]||(t[6]=s=>r.sale_price=s),label:"Sale Price",error:h.sale_price,type:"number"},null,8,["modelValue","error"]),e("div",tt,[e("div",st,[t[17]||(t[17]=e("label",{for:"unit",class:"block text-sm font-medium mb-1 text-gray-700"}," Unit ",-1)),x(fe,{id:"unit",modelValue:r.unit,"onUpdate:modelValue":t[7]||(t[7]=s=>r.unit=s),options:a.units.map(s=>({label:s.name,value:s.name})),placeholder:"Select Unit",class:"w-full",error:h.unit},null,8,["modelValue","options","error"])]),e("button",{type:"button",onClick:L,class:"flex items-center justify-center px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm gap-1 mt-6"},[...t[18]||(t[18]=[e("i",{class:"pi pi-plus"},null,-1),se(" Add Unit ",-1)])])])])]),_:1},8,["modelValue","title","disableSaveBtn"])]))}}};export{yt as default};
