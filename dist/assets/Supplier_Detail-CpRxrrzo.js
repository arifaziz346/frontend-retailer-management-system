import{a as d}from"./axios-BiTBWfu5.js";import{_ as z}from"./Button-Bw5MEUH8.js";import{j as w,r as n,l as L,z as q,c as m,a as e,b as p,u as g,n as S,y as M,t as r,F as G,q as H,h as J,o as x}from"./index-gUTQSAyF.js";import{V as K}from"./vue-spinner-tail-BWqZ-Nnh.js";import{_ as Q}from"./BaseModal-BRE-_Uh2.js";import{_ as k}from"./FormInput-CQaqcyQa.js";import{_ as W}from"./Pagination-k5friDJS.js";import{t as u}from"./toast-kIWbnzaY.js";import{u as X}from"./useFormErrors-BWkWHfi_.js";/* empty css                                                                  */import"./lodash-ZBiWZE3y.js";import{r as V}from"./helper-B0BtwXvx.js";import"./stringHelpers-DhATn_QK.js";import"./sweetalert2.esm.all-BQxta0Da.js";const Y={key:0,class:"fixed inset-0 flex items-center justify-center bg-white/70 backdrop-blur-sm z-50"},Z={class:"flex flex-col items-center space-y-3"},ee={key:1,class:"flex flex-col min-h-screen bg-gray-50 overflow-x-hidden"},te={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between bg-white border-b border-gray-200 px-4 py-3 shadow-sm rounded-lg"},se={class:"flex items-center space-x-2 text-sm md:text-base text-gray-600"},le={class:"overflow-x-auto border border-gray-300 rounded-md shadow-sm mt-4"},oe={class:"min-w-full border-collapse text-xs sm:text-sm md:text-base"},re={class:"border-t border-gray-200 text-xs"},ae={class:"px-4 py-2"},ie={class:"px-4 py-2"},ne={class:"px-4 py-2"},pe={class:"px-4 py-2"},de={class:"px-4 py-2"},ue={class:"px-4 py-2"},ce={class:"px-4 py-2"},me={class:"px-4 py-2"},xe={class:"px-4 py-2 font-semibold"},fe={class:"flex-1 mt-1"},_e={class:"w-full overflow-x-scroll border border-gray-300 rounded-md shadow-sm"},ye={class:"w-full bg flex flex-row items-center bg-gray-800 text-white p-1.5 justify-between"},be={key:0,class:"min-w-full border border-gray-200 bg-white rounded-xl overflow-hidden shadow-sm text-xs sm:text-sm md:text-base"},ve={class:"px-4 py-2 font-medium text-gray-800"},ge={class:"px-4 py-2 font-medium text-gray-900"},he={class:"px-4 py-2 text-gray-700"},we={class:"px-4 py-2 text-gray-700"},Se={class:"px-4 py-2 text-gray-700"},ke={class:"px-4 py-2 text-gray-700"},Ve={class:"px-4 py-2 flex flex-col sm:flex-row justify-center gap-2"},Ce=["onClick"],Oe=["onClick"],$e=["onClick"],Ie={key:1,class:"flex flex-col items-center justify-center h-[60vh] text-center"},Pe={class:"bg-white p-4 rounded-lg shadow-2xl space-y-2"},Je={__name:"Supplier_Detail",setup(De){const y=q(),C=J(),a=w({supplier:[],supplier_order:[],pagination:{currentPage:1,nextPageUrl:null,prevPageUrl:null,lastPage:1}}),i=n(!1);n(!1);const f=n(!1),O=n(""),_=n(!1);n("");const b=n(0),h=n(0),P=n(0),l=w({supplier_id:"",supplier_invoice_number:"",transport_cost:0,supplier_invoice_date:""}),c=w({supplier_id:"",supplier_invoice_number:"",transport_cost:"",supplier_invoice_date:""}),D=X(c),T=async()=>{i.value=!0;try{let s;f.value?(s=await d.put(`/supplier-orders/${l.id}`,l),u.success("Supplier Order updated successfully"),v(l.supplier_id)):(s=await d.post("/supplier-orders",l),u.success("Supplier Order created successfully"),v(l.supplier_id)),$()}catch(s){s.response&&s.response.status===422?(console.log("Validation errors:",s.response.data.errors),D(s)):u.error("An error occurred while saving the supplier order")}finally{i.value=!1}},E=s=>{f.value=!0,l.id=s.id,l.supplier_invoice_number=s.supplier_invoice_number,l.transport_cost=s.transport_cost,l.total_amount=s.total_amount,l.total_items=s.total_items,l.supplier_invoice_date=s.supplier_invoice_date,_.value=!0},v=async s=>{try{i.value=!0;const t=await d.get(`/supplier-orders/${s}`);a.supplier_order=t.data.data,console.log("fetch Supplier response-",t.data)}catch(t){console.error("Error fetching order:",t),u.error("Failed to fetch order")}finally{i.value=!1}},F=async s=>{try{i.value=!0;const t=await d.get(`/supplier-payments/total/${s}`);b.value=t.data.data.paid_total_supplier,console.log("fetchTotalPaidToSupplier-",t.data.data)}catch(t){console.log("fail to fetch total Order Items",t)}},N=async s=>{try{i.value=!0;const t=await d.get(`/supplier-order-items/total/${s}`);h.value=t.data.data.total_purchased_amount,P.value=t.data.data.total_item_quanity,console.log("fetchTotalOrderItems-",t.data.data)}catch(t){console.log("fail to fetch total Order Items",t)}},$=()=>{l.supplier_invoice_number="",l.transport_cost="",l.supplier_invoice_date="",Object.keys(c).forEach(s=>c[s]=""),_.value=!1,f.value=!1},j=async s=>{i.value=!0;try{const t=await d.get(`/suppliers/${s}`);a.supplier=t.data.data,console.log("Supplier Details:",a.supplier)}catch(t){console.error("Error fetching supplier details:",t),u.error("Failed to fetch supplier details")}finally{i.value=!1}},A=s=>{C.push({name:"admin.stock-invoice",params:{id:s.id,supplier_id:O.value}})},R=s=>{C.push({name:"admin.supplier-payments",params:{supplier_id:s}})},U=async s=>{if(confirm("Are you sure you want to delete this supplier Order Invoice?")){i.value=!0;try{const t=await d.delete(`/supplier-orders/${s}`);t.data.success&&(v(l.supplier_id),u.success(t.data.message||"Supplier Order Invoice deleted successfully"))}catch(t){console.error("Error deleting supplier:",t),u.error("Failed to delete supplier")}finally{i.value=!1}}};return L(async()=>{l.supplier_id=y.params.id?y.params.id:"",O.value=y.params.id?y.params.id:"",await F(l.supplier_id),await N(l.supplier_id),await j(l.supplier_id),await v(l.supplier_id)}),(s,t)=>{const B=M("router-link");return i.value?(x(),m("div",Y,[e("div",Z,[p(g(K),{size:"48px",color:"#2563eb"}),t[7]||(t[7]=e("p",{class:"text-blue-600 text-sm font-medium animate-pulse"}," Loading, please wait... ",-1))])])):(x(),m("div",ee,[e("header",te,[e("nav",se,[p(B,{to:"/admin/Supplier",class:"flex items-center hover:text-blue-600 transition-colors"},{default:S(()=>[...t[8]||(t[8]=[e("i",{class:"pi pi-home mr-1 text-2xl"},null,-1),e("span",{class:"sm:inline"},"Supplier",-1)])]),_:1}),t[9]||(t[9]=e("span",{class:"font-semibold text-gray-900"},"/",-1)),t[10]||(t[10]=e("span",{class:"sm:inline font-bold"},"Supplier-Detail",-1))])]),e("div",le,[e("table",oe,[t[12]||(t[12]=e("thead",{class:"bg-gray-100 text-gray-700 text-xs"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left font-semibold"},"Name"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Contact"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Company Name"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Account No."),e("th",{class:"px-4 py-2 text-left font-semibold"},"Liabilities"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Purchased Amount"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Amount Paid"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Remaining"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Action")])],-1)),e("tbody",null,[e("tr",re,[e("td",ae,r(a.supplier.name||"-"),1),e("td",ie,r(a.supplier.contact_person||"-"),1),e("td",ne,r(a.supplier.company_name||"-"),1),e("td",pe,r(a.supplier.account_number||"-"),1),e("td",de," Rs."+r(Math.max(0,a.supplier.liabilities-b.value)||0),1),e("td",ue,"Rs."+r(g(V)(h.value)||"-"),1),e("td",ce,"Rs."+r(g(V)(b.value)||"-"),1),e("td",me,"Rs."+r(g(V)(h.value-b.value)||"-"),1),e("td",xe,[e("button",{onClick:t[0]||(t[0]=o=>R(a.supplier.id)),class:"flex flex-col sm:flex-row items-center gap-1 p-2 bg-emerald-500 hover:bg-emerald-600 text-white rounded-md shadow text-xs"},[...t[11]||(t[11]=[e("i",{class:"pi pi-money-bill text-base"},null,-1),e("span",null,"Payments",-1)])])])])])])]),e("main",fe,[e("div",_e,[e("div",ye,[t[14]||(t[14]=e("i",{class:"pi pi-home mr-1 text-lg"}," Stock Invoices",-1)),p(z,{variant:"primary",size:"sm",class:"flex items-center justify-center gap-1 bg-blue-600 hover:bg-blue-700 text-white px-1 py-2 rounded-lg shadow-sm transition-all duration-150 mt-3 sm:mt-0",onClick:t[1]||(t[1]=()=>{$(),f.value=!1,_.value=!0})},{default:S(()=>[...t[13]||(t[13]=[e("i",{class:"pi pi-plus text-sm"},null,-1),e("span",null,"Stock-Invoices",-1)])]),_:1})]),a.supplier_order&&a.supplier_order.length?(x(),m("table",be,[t[18]||(t[18]=e("thead",{class:"bg-gray-100 text-gray-700 text-xs"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left font-semibold"},"#"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Invoice-Number"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Date"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Transport-Cost"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Total-Items"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Purchased-Amount"),e("th",{class:"px-4 py-2 text-left font-semibold"},"Actions")])],-1)),e("tbody",null,[(x(!0),m(G,null,H(a.supplier_order,(o,Te)=>(x(),m("tr",{key:o.id,class:"border-t border-t-gray-300 hover:bg-gray-50 transition ext-sm text-xs"},[e("td",ve,r(o.id),1),e("td",ge,r(o.supplier_invoice_number||"-"),1),e("td",he,r(o.supplier_invoice_date||"-"),1),e("td",we,r(o.transport_cost||"-"),1),e("td",Se,r(o.total_items||"-"),1),e("td",ke,r(o.total_purchased_amount||"-"),1),e("td",Ve,[e("button",{onClick:I=>A(o),class:"flex flex-col sm:flex-row items-center gap-1 p-2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-md shadow text-xs"},[...t[15]||(t[15]=[e("i",{class:"pi pi-eye text-base"},null,-1),e("span",null,"View",-1)])],8,Ce),e("button",{onClick:I=>E(o),class:"flex flex-col sm:flex-row items-center gap-1 p-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md shadow text-xs"},[...t[16]||(t[16]=[e("i",{class:"pi pi-pencil text-base"},null,-1),e("span",null,"Edit",-1)])],8,Oe),e("button",{onClick:I=>U(o.id),class:"flex flex-col sm:flex-row items-center gap-1 p-2 bg-red-500 hover:bg-red-600 text-white rounded-md shadow text-xs"},[...t[17]||(t[17]=[e("i",{class:"pi pi-trash text-base"},null,-1),e("span",null,"Delete",-1)])],8,$e)])]))),128))])])):(x(),m("div",Ie,[...t[19]||(t[19]=[e("img",{src:"https://cdn-icons-png.flaticon.com/512/4076/4076549.png",alt:"No Data",class:"w-32 h-32 opacity-70 mb-4"},null,-1),e("h2",{class:"text-xl font-semibold text-gray-700 mb-2"},"No Suppliers Found",-1),e("p",{class:"text-gray-500"}," Try adding new suppliers to see them listed here. ",-1)])])),p(W,{pagination:a.pagination,onPageChange:s.fetchSuppliers},null,8,["pagination","onPageChange"])])]),p(Q,{modelValue:_.value,"onUpdate:modelValue":t[5]||(t[5]=o=>_.value=o),title:f.value?"Edit Supplier_Order":"Create Supplier Order",onSave:t[6]||(t[6]=()=>T()),disableSaveBtn:i.value},{default:S(()=>[e("div",Pe,[p(k,{id:"supplier_invoice_number",label:"Supplier Invoice Number",modelValue:l.supplier_invoice_number,"onUpdate:modelValue":t[2]||(t[2]=o=>l.supplier_invoice_number=o),error:c.supplier_invoice_number},null,8,["modelValue","error"]),p(k,{id:"transport_cost",label:"Transport Cost",modelValue:l.transport_cost,"onUpdate:modelValue":t[3]||(t[3]=o=>l.transport_cost=o),error:c.transport_cost},null,8,["modelValue","error"]),p(k,{id:"supplier_invoice_date",label:"Supplier Invoice Date",modelValue:l.supplier_invoice_date,"onUpdate:modelValue":t[4]||(t[4]=o=>l.supplier_invoice_date=o),type:"date",error:c.supplier_invoice_date},null,8,["modelValue","error"])])]),_:1},8,["modelValue","title","disableSaveBtn"])]))}}};export{Je as default};
