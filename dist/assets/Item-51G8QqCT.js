import{a as k}from"./axios-BhsMpkwj.js";import{l as W,c as i,o as d,f as $,a as e,t as u,F as S,s as I,u as A,H as E,I as z,w as M,B as T,r as y,v as X,k as U,q as Z,m as ee,z as te,b as x,p as F,y as se,e as N,i as oe,x as q,J as le}from"./index-SP6IRfbS.js";import{V as ae}from"./vue-spinner-tail-odXgjERA.js";import{_ as re}from"./BaseModal-CGQ-Y19B.js";import{_ as P}from"./FormInput-D68lHcZY.js";import{c as ne}from"./stringHelpers-DhATn_QK.js";import{_ as ie}from"./Pagination-DW_A4LDw.js";import{t as B}from"./toast-BWxgGeSH.js";import{u as de}from"./useFormErrors-BWkWHfi_.js";import{p as ce}from"./helper-B0BtwXvx.js";import{_ as ue}from"./lodash-BhnIiNWo.js";const pe={class:"flex flex-col"},me=["for"],ge=["id","value","disabled"],fe={key:0,value:""},be=["value"],xe={key:1,class:"text-red-600 text-sm mt-1"},ye={__name:"Selector",props:{id:String,label:String,modelValue:[String,Number],options:{type:[Array,Object],required:!0},placeholder:{type:String,default:""},error:String,disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:v}){const f=n,l=v,p=W(()=>Array.isArray(f.options)?f.options.map(o=>typeof o=="object"?{label:o.label??o.name??o.value,value:o.value??o.id??o.label}:{label:o,value:o}):Object.entries(f.options).map(([o,_])=>({label:_,value:o}))),m=o=>{l("update:modelValue",o.target.value)};return(o,_)=>(d(),i("div",pe,[n.label?(d(),i("label",{key:0,for:n.id,class:"text-xs lg:text-sm font-medium mb-1"},u(n.label),9,me)):$("",!0),e("select",{id:n.id,value:n.modelValue,disabled:n.disabled,onChange:m,class:"placeholder:italic placeholder:text-slate-400 block bg-white w-full border border-slate-300 rounded-md py-1.5 pl-3 pr-10 shadow-sm focus:outline-none focus:border-sky-500 focus:ring-sky-500 focus:ring-1 sm:text-sm"},[n.placeholder?(d(),i("option",fe,u(n.placeholder),1)):$("",!0),(d(!0),i(S,null,I(p.value,(c,g)=>(d(),i("option",{key:g,value:c.value},u(c.label),9,be))),128))],40,ge),n.error?(d(),i("p",xe,u(A(ne)(n.error)),1)):$("",!0)]))}},ve={class:"flex items-start gap-2 w-full"},_e={class:"flex-1 min-w-0"},he={class:"block text-sm font-medium mb-1"},we={class:"relative w-auto"},ke=["value"],Ve={__name:"TypeSelector",props:E({label:{type:String,default:"Select"},sub_categories:{type:Array,default:()=>[]},error:String,button_name:{type:String,default:"Add"},show_button:{type:Boolean,default:!0}},{modelValue:{default:"other"},modelModifiers:{}}),emits:E(["click_sub_category"],["update:modelValue"]),setup(n,{emit:v}){const f=z(n,"modelValue"),l=v;return(p,m)=>(d(),i("div",ve,[e("div",_e,[e("label",he,u(n.label),1),e("div",we,[M(e("select",{"onUpdate:modelValue":m[0]||(m[0]=o=>f.value=o),class:"placeholder:italic placeholder:text-slate-400 block bg-white w-full border border-slate-300 rounded-md py-1.5 pl-3 pr-10 shadow-sm focus:outline-none focus:border-sky-500 focus:ring-sky-500 focus:ring-1 sm:text-sm"},[m[2]||(m[2]=e("option",{value:"other"},"Other",-1)),(d(!0),i(S,null,I(n.sub_categories,o=>(d(),i("option",{key:o.id,value:o.id},u(o.category_name),9,ke))),128))],512),[[T,f.value]])])]),n.show_button?(d(),i("button",{key:0,class:"mt-6 bg-green-600 hover:bg-green-700 text-white px-4 py-1.5 rounded-md shadow-sm border border-green-700",onClick:m[1]||(m[1]=o=>l("click_sub_category"))},u(n.button_name),1)):$("",!0)]))}},Ce={class:"flex flex-row justify-between sm:flex-row items-center gap-1 w-full"},$e={class:"w-1/8"},Se=["value"],Ie={class:"relative w-full sm:w-1/4"},Ue={key:0,class:"pi pi-search absolute right-3 bottom-2.5 text-gray-400"},Pe={__name:"FilterBar",props:{subCategories:{type:Array,default:()=>[]},showButton:{type:Boolean,default:!0}},emits:["update:search","update:category_id","click_add_category"],setup(n,{emit:v}){const f=v,l=y(""),p=y(""),m=()=>{f("update:search",l.value),f("update:category_id",p.value)},o=()=>{l.value="",m()};return(_,c)=>(d(),i("div",Ce,[e("div",$e,[M(e("select",{"onUpdate:modelValue":c[0]||(c[0]=g=>p.value=g),onChange:m,class:"placeholder:italic placeholder:text-slate-400 block bg-white w-full border border-slate-300 rounded-md py-1.5 pl- pr-10 shadow-sm focus:outline-none focus:border-sky-500 focus:ring-sky-500 focus:ring-1 sm:text-sm"},[c[2]||(c[2]=e("option",{value:""},"All Categories",-1)),(d(!0),i(S,null,I(n.subCategories,g=>(d(),i("option",{key:g.id,value:g.id},u(g.category_name),9,Se))),128))],544),[[T,p.value]])]),e("div",Ie,[M(e("input",{"onUpdate:modelValue":c[1]||(c[1]=g=>l.value=g),onInput:m,type:"text",placeholder:"Search Item...",class:"placeholder:italic placeholder:text-slate-400 block bg-white w-full border border-slate-300 rounded-md py-1.5 pl-3 pr-10 shadow-sm focus:outline-none focus:border-sky-500 focus:ring-sky-500 focus:ring-1 sm:text-sm"},null,544),[[X,l.value]]),l.value?(d(),i("i",{key:1,onClick:o,class:"pi pi-times absolute right-3 bottom-2.5 text-gray-400 cursor-pointer"})):(d(),i("i",Ue))])]))}},Be={key:0,class:"fixed inset-0 flex items-center justify-center bg-slate-900/10 backdrop-blur-md z-[100]"},Ae={class:"flex flex-col items-center p-8 bg-white rounded-3xl shadow-2xl border border-white"},Me={key:1,class:"flex flex-col min-h-screen bg-[#f8fafc] w-full"},je={class:"sticky top-0 z-30 w-full bg-white border-b border-slate-200 shadow-sm"},Ee={class:"w-full px-4 sm:px-8 py-4 flex flex-col md:flex-row md:items-center justify-between gap-4"},Fe={class:"flex flex-col"},Ne={class:"flex items-center space-x-2 text-xs font-bold text-slate-400 uppercase tracking-wider mb-1"},qe={class:"text-blue-600"},ze={class:"w-full px-4 sm:px-8 py-6"},Te={class:"w-full mb-8"},De={key:0,class:"bg-white border border-slate-200 rounded-2xl shadow-sm overflow-hidden w-full"},Oe={class:"overflow-x-auto w-full"},Re={class:"w-full text-left border-collapse min-w-[1000px]"},Le={class:"divide-y divide-slate-50"},He={class:"px-6 py-4"},Ge={class:"flex flex-col"},Je={class:"font-bold text-slate-800 text-base group-hover:text-blue-700 transition-colors"},Ye={class:"text-xs font-mono text-slate-400 mt-1"},Ke={class:"px-6 py-4"},Qe={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-bold bg-slate-100 text-slate-600 border border-slate-200"},We={class:"px-6 py-4"},Xe={class:"text-sm font-bold text-slate-700"},Ze={class:"text-[11px] text-slate-400 font-medium tracking-tight"},et={class:"px-6 py-4"},tt={class:"flex items-baseline gap-2"},st={class:"text-sm font-black text-green-600 tracking-tighter"},ot={class:"text-[10px] font-bold text-green-500/80 bg-green-50 px-1.5 py-0.5 rounded"},lt={class:"px-6 py-4"},at={class:"flex flex-col gap-1.5"},rt={class:"flex justify-between text-[10px] font-bold uppercase tracking-tighter"},nt={class:"w-full bg-slate-100 h-2 rounded-full overflow-hidden border border-slate-200/50"},it={class:"px-6 py-4 text-right"},dt={class:"flex justify-end items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity"},ct=["onClick"],ut=["onClick"],pt={class:"bg-slate-50/50 px-8 py-4 border-t border-slate-100"},mt={key:1,class:"w-full py-32 flex flex-col items-center justify-center bg-white border-2 border-dashed border-slate-200 rounded-[2rem]"},gt={class:"grid grid-cols-1 md:grid-cols-2 gap-6 p-2"},ft={class:"md:col-span-2"},bt={class:"space-y-2"},xt={class:"flex gap-2"},Ut={__name:"Item",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(n){const v=te(),f=oe();z(n,"modelValue");const l=U({items:[],units:[],categories:[],pagination:{currentPage:1,nextPageUrl:null,prevPageUrl:null,lastPage:1}}),p=y(),m=y(),o=y(!1),_=y(!1),c=y(!1),g=y(""),h=y(!1),V=y(""),r=U({name:"",category_id:p.value,sale_price:"",cost_price:"",stock:"",unit:""}),w=U({name:"",sale_price:"",category_id:"",cost_price:"",unit:""}),D=de(w),O=ue.debounce(()=>{_.value=!0,C()},500);Z([V,p],()=>{O()});const R=()=>{f.push("/admin/unit")},C=async(a="/items")=>{try{_.value?_.value=!0:o.value=!0;const t=await k.get(a,{params:{search:V.value||null,category_id:p.value||null}});console.log("Items fetched:",t.data);const b=t.data.data;l.items=b.data,l.pagination.currentPage=b.current_page,l.pagination.lastPage=b.last_page,l.pagination.nextPageUrl=b.next_page_url,l.pagination.prevPageUrl=b.prev_page_url}catch(t){console.log("Error fetching items:",t)}finally{o.value=!1,_.value=!1}},L=async()=>{try{const a=await k.get("/categories");l.categories=a.data.categories}catch(a){console.log("Error fetching categories:",a)}},j=()=>{r.name="",r.sale_price="",r.cost_price="",r.unit="",r.category_id=p.value||0,Object.keys(w).forEach(a=>w[a]=""),h.value=!1,c.value=!1,g.value=""},H=a=>{c.value=!0,g.value=a.id,r.name=a.name,r.sale_price=a.sale_price,r.cost_price=a.cost_price,r.unit=a.unit,r.category_id=a.category_id,h.value=!0},G=async()=>{o.value=!0;try{const a={name:r.name,sale_price:r.sale_price,cost_price:r.cost_price,unit:r.unit,category_id:r.category_id};let t;if(c.value?t=await k.put(`/items/${g.value}`,a):t=await k.post("/items",a),!c.value)l.items.unshift(t.data.item);else{const b=l.items.findIndex(s=>s.id===g.value);b!==-1&&(l.items[b]=t.data.item)}t.data.success&&(C(),B.success(t.data.message||(c.value?"Item updated successfully":"Item created successfully")),j())}catch(a){console.error("Error saving/updating item:",a),D(a)}finally{o.value=!1}},J=async a=>{if(confirm("Are you sure you want to delete this item?")){o.value=!0;try{const t=await k.delete(`/items/${a}`);l.items=l.items.filter(b=>b.id!==a),t.data.success&&B.success(t.data.message||(c.value?"Item updated successfully":"Item created successfully"))}catch(t){console.error("Error deleting item:",t),B.error("Failed to delete item")}finally{o.value=!1}}},Y=()=>{f.push("/admin/category")},K=async()=>{try{const a=await k.get("/units");l.units=a.data.data,console.log("Units fetched:",l.units)}catch(a){console.log("Error fetching units:",a)}};return ee(async()=>{p.value=v.params.id||0,m.value=v.params.category_name||"",r.category_id=p.value,await C(),await L(),await K()}),(a,t)=>{const b=se("router-link");return o.value?(d(),i("div",Be,[e("div",Ae,[x(A(ae),{size:"50px",color:"#2563eb"}),t[11]||(t[11]=e("p",{class:"text-slate-500 text-xs font-bold mt-4 tracking-[0.2em] uppercase"},"Processing Data",-1))])])):(d(),i("div",Me,[e("header",je,[e("div",Ee,[e("div",Fe,[e("nav",Ne,[x(b,{to:"/admin/Item",class:"hover:text-blue-600 transition-colors"},{default:F(()=>[...t[12]||(t[12]=[N("Inventory",-1)])]),_:1}),t[13]||(t[13]=e("i",{class:"pi pi-chevron-right text-[10px]"},null,-1)),e("span",qe,u(m.value||"All Categories"),1)]),t[14]||(t[14]=e("h1",{class:"text-2xl font-black text-slate-800 tracking-tight"},"Product Management",-1))]),e("button",{class:"inline-flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 active:scale-95 text-white px-6 py-3 rounded-xl font-bold shadow-lg shadow-blue-200 transition-all text-sm",onClick:t[0]||(t[0]=()=>{j(),c.value=!1,h.value=!0,a.addVariant()})},[...t[15]||(t[15]=[e("i",{class:"pi pi-plus-circle"},null,-1),e("span",null,"Create New Item",-1)])])])]),e("main",ze,[e("div",Te,[x(Pe,{subCategories:l.categories,search:V.value,"onUpdate:search":t[1]||(t[1]=s=>V.value=s),category_id:p.value,"onUpdate:category_id":t[2]||(t[2]=s=>p.value=s),showButton:!1,class:"w-full"},null,8,["subCategories","search","category_id"])]),l.items&&l.items.length?(d(),i("div",De,[e("div",Oe,[e("table",Re,[t[19]||(t[19]=e("thead",null,[e("tr",{class:"bg-slate-50/80 text-slate-500 uppercase text-[11px] font-bold tracking-widest border-b border-slate-100"},[e("th",{class:"px-6 py-5"},"Product Info"),e("th",{class:"px-6 py-5"},"Category"),e("th",{class:"px-6 py-5"},"Pricing (Cost/Sale)"),e("th",{class:"px-6 py-5"},"Profit Analysis"),e("th",{class:"px-6 py-5 w-[200px]"},"Inventory Health"),N(),e("th",{class:"px-6 py-5 text-right"},"Actions")])],-1)),e("tbody",Le,[(d(!0),i(S,null,I(l.items,s=>(d(),i("tr",{key:s.id,class:"hover:bg-blue-50/40 transition-all group"},[e("td",He,[e("div",Ge,[e("span",Je,u(s.name),1),e("span",Ye,"#"+u(s.unique_barcode||s.id),1)])]),e("td",Ke,[e("span",Qe,u(s.category?.category_name||"General"),1)]),e("td",We,[e("div",Xe,"Rs."+u(s.sale_price),1),e("div",Ze,"Net Cost: Rs."+u(s.cost_price),1)]),e("td",et,[e("div",tt,[e("span",st,"+"+u((s.sale_price-s.cost_price).toFixed(0)),1),e("span",ot,u(A(ce)(s.sale_price,s.cost_price)),1)])]),e("td",lt,[e("div",at,[e("div",rt,[e("span",{class:q(s.quantity_in_stock<10?"text-red-500":"text-slate-500")},u(s.quantity_in_stock||0)+" "+u(s.unit||"pcs"),3),t[16]||(t[16]=e("span",{class:"text-slate-400"},"Target: 100",-1))]),e("div",nt,[e("div",{class:q(["h-full rounded-full transition-all duration-1000",[s.quantity_in_stock>20?"bg-blue-500":s.quantity_in_stock>5?"bg-amber-400":"bg-red-500"]]),style:le({width:Math.min(s.quantity_in_stock/100*100,100)+"%"})},null,6)])])]),e("td",it,[e("div",dt,[e("button",{onClick:Q=>H(s),class:"p-2 hover:bg-blue-100 text-blue-600 rounded-lg transition-colors"},[...t[17]||(t[17]=[e("i",{class:"pi pi-pencil text-sm"},null,-1)])],8,ct),e("button",{onClick:Q=>J(s.id),class:"p-2 hover:bg-red-100 text-red-500 rounded-lg transition-colors"},[...t[18]||(t[18]=[e("i",{class:"pi pi-trash text-sm"},null,-1)])],8,ut)])])]))),128))])])]),e("div",pt,[x(ie,{pagination:l.pagination,onPageChange:C},null,8,["pagination"])])])):(d(),i("div",mt,[t[20]||(t[20]=e("div",{class:"p-6 bg-slate-50 rounded-full mb-4"},[e("i",{class:"pi pi-box text-5xl text-slate-300"})],-1)),t[21]||(t[21]=e("h3",{class:"text-xl font-bold text-slate-800"},"Your inventory is empty",-1)),t[22]||(t[22]=e("p",{class:"text-slate-500 mb-6"},"Start tracking your products by clicking the button below.",-1)),e("button",{onClick:t[3]||(t[3]=s=>h.value=!0),class:"text-blue-600 font-bold hover:text-blue-700"},"+ Add First Product")]))]),x(re,{modelValue:h.value,"onUpdate:modelValue":t[9]||(t[9]=s=>h.value=s),title:c.value?"Modify Product Information":"Catalog New Item",onSave:t[10]||(t[10]=()=>G()),disableSaveBtn:o.value,panelClass:"max-w-2xl"},{default:F(()=>[e("div",gt,[e("div",ft,[x(P,{id:"name",label:"Item Name",modelValue:r.name,"onUpdate:modelValue":t[4]||(t[4]=s=>r.name=s),placeholder:"Enter product name...",error:w.name},null,8,["modelValue","error"])]),x(Ve,{modelValue:r.category_id,"onUpdate:modelValue":t[5]||(t[5]=s=>r.category_id=s),sub_categories:l.categories||[],error:w?.category_id,button_name:"+ New",label:"Category",onClick_sub_category:Y},null,8,["modelValue","sub_categories","error"]),e("div",bt,[t[24]||(t[24]=e("label",{class:"block text-sm font-bold text-slate-700"},"Unit of Measure",-1)),e("div",xt,[x(ye,{id:"unit",modelValue:r.unit,"onUpdate:modelValue":t[6]||(t[6]=s=>r.unit=s),options:l.units.map(s=>({label:s.name,value:s.name})),placeholder:"Unit",class:"flex-1",error:w.unit},null,8,["modelValue","options","error"]),e("button",{onClick:R,class:"p-2 bg-slate-100 rounded-lg hover:bg-slate-200"},[...t[23]||(t[23]=[e("i",{class:"pi pi-plus"},null,-1)])])])]),x(P,{modelValue:r.cost_price,"onUpdate:modelValue":t[7]||(t[7]=s=>r.cost_price=s),label:"Cost Price (Base)",type:"number"},null,8,["modelValue"]),x(P,{modelValue:r.sale_price,"onUpdate:modelValue":t[8]||(t[8]=s=>r.sale_price=s),label:"Selling Price",type:"number"},null,8,["modelValue"])])]),_:1},8,["modelValue","title","disableSaveBtn"])]))}}};export{Ut as default};
