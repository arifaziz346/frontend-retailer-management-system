import{r as x,j as h,l as D,c as m,f as C,a as e,b as i,u as M,F as B,q as I,n as O,o as f,t as d,e as V,s as A,w as k,B as E,v as F}from"./index-DppJ4uJc.js";import{a as b}from"./axios-pwxHYZIu.js";import{t as g}from"./toast-kIWbnzaY.js";import{V as z}from"./vue-spinner-tail-D8qEx31J.js";import{_ as L}from"./BaseModal-DaTHTPvo.js";import{_ as v}from"./FormInput-DqkHBGkx.js";import{_ as T}from"./Pagination-hmH0ImhT.js";import"./sweetalert2.esm.all-BQxta0Da.js";import"./stringHelpers-DhATn_QK.js";const R={class:"flex flex-col min-h-screen bg-slate-50 font-sans"},q={key:0,class:"fixed inset-0 flex items-center justify-center bg-white/80 backdrop-blur-sm z-50"},G={class:"bg-white border-b border-slate-200 sticky top-0 z-10 shadow-sm"},H={class:"max-w-7xl mx-auto px-6 py-4 flex flex-col md:flex-row md:items-center md:justify-between gap-4"},J={class:"max-w-7xl mx-auto w-full p-6"},K={class:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden"},Q={class:"overflow-x-auto"},W={class:"w-full text-sm text-left"},X={class:"divide-y divide-slate-100"},Y={class:"px-6 py-4 text-slate-500 font-mono text-xs"},Z={class:"px-6 py-4"},ee={class:"font-bold text-slate-900"},te={class:"px-6 py-4"},se={class:"flex flex-col gap-1"},ae={class:"flex items-center gap-2 text-slate-700"},le={key:0,class:"flex items-center gap-2 text-slate-500 text-xs"},oe={class:"px-6 py-4"},ne={class:"bg-slate-100 text-slate-700 px-2 py-1 rounded text-xs border border-slate-200 uppercase"},re={class:"px-6 py-4 max-w-xs truncate text-slate-600"},ie={class:"px-6 py-4 text-center"},de={class:"px-6 py-4 text-right"},pe={class:"flex justify-end gap-2"},ue=["onClick"],ce=["onClick"],xe={class:"grid grid-cols-1 md:grid-cols-2 gap-4 py-2"},me={class:"md:col-span-2"},fe={class:"md:col-span-2"},ge=4,Pe={__name:"Customer",setup(be){const o=x(!1),p=x(!1),u=x(!1),r=h({customers:{data:[]},pagination:{currentPage:1,nextPageUrl:null,prevPageUrl:null,lastPage:1}}),a=h({id:null,name:"",phone_one:"",phone_two:"",address:"",nic:"",status:"active"}),n=h({}),_=()=>{Object.assign(a,{id:null,name:"",phone_one:"",phone_two:"",address:"",nic:"",status:"active"}),Object.keys(n).forEach(l=>n[l]="")},y=x(""),w=x(!1),c=async(l="/customers")=>{try{y.value?w.value=!0:o.value=!0;const s=(await b.get(l,{params:{search:y.value||null,per_page:ge}})).data.data;console.log("paginated",s),r.customers=s.data.data||s,r.pagination.currentPage=s.current_page??1,r.pagination.lastPage=s.last_page??1,r.pagination.nextPageUrl=s.next_page_url??null,r.pagination.prevPageUrl=s.prev_page_url??null}catch(t){console.error(t),g.error("Failed to fetch customers")}finally{o.value=!1,w.value=!1}},N=()=>{_(),u.value=!1,p.value=!0},P=async()=>{try{o.value=!0;const l=await b.post("/customers",a);g.success("Customer added successfully"),p.value=!1,c()}catch(l){console.log(l),l.response?.data?.errors&&Object.assign(n,l.response.data.errors)}finally{o.value=!1}},U=l=>{_(),Object.assign(a,l),u.value=!0,p.value=!0},j=async()=>{try{o.value=!0,await b.put(`/customers/${a.id}`,a),g.success("Customer profile updated"),p.value=!1,c()}catch(l){l.response?.data?.errors&&Object.assign(n,l.response.data.errors)}finally{o.value=!1}},S=async l=>{if(confirm("Delete this customer permanently?"))try{await b.delete(`/customers/${l}`),g.success("Record deleted"),c()}catch{g.error("Deletion failed")}};return D(()=>c()),(l,t)=>(f(),m("div",R,[o.value?(f(),m("div",q,[i(M(z),{size:"50px",color:"#2563eb"})])):C("",!0),e("header",G,[e("div",H,[t[10]||(t[10]=e("div",null,[e("h1",{class:"text-2xl font-bold text-slate-800"},"Customers"),e("p",{class:"text-sm text-slate-500"},"Manage customer records, NICs, and contact details")],-1)),e("button",{onClick:t[0]||(t[0]=s=>(N(),u.value=!1)),class:"inline-flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg font-semibold transition-all shadow-md active:scale-95"},[...t[9]||(t[9]=[e("i",{class:"pi pi-plus text-xs"},null,-1),e("span",null,"New Customer",-1)])])])]),e("main",J,[e("div",K,[e("div",Q,[e("table",W,[t[15]||(t[15]=e("thead",{class:"bg-slate-50 text-slate-600 font-semibold border-b border-slate-200"},[e("tr",null,[e("th",{class:"px-6 py-4"},"ID"),e("th",{class:"px-6 py-4"},"Name"),e("th",{class:"px-6 py-4"},"Contact Info"),e("th",{class:"px-6 py-4"},"NIC Number"),e("th",{class:"px-6 py-4"},"Address"),e("th",{class:"px-6 py-4 text-center"},"Status"),e("th",{class:"px-6 py-4 text-right"},"Actions")])],-1)),e("tbody",X,[(f(!0),m(B,null,I(r.customers.data,s=>(f(),m("tr",{key:s.id,class:"hover:bg-slate-50 transition-colors"},[e("td",Y,"#"+d(s.id),1),e("td",Z,[e("span",ee,d(s.name),1)]),e("td",te,[e("div",se,[e("span",ae,[t[11]||(t[11]=e("i",{class:"pi pi-phone text-[10px] text-blue-500"},null,-1)),V(" "+d(s.phone_one),1)]),s.phone_two?(f(),m("span",le,[t[12]||(t[12]=e("i",{class:"pi pi-phone text-[10px] text-slate-400"},null,-1)),V(" "+d(s.phone_two),1)])):C("",!0)])]),e("td",oe,[e("span",ne,d(s.nic||"N/A"),1)]),e("td",re,d(s.address||"---"),1),e("td",ie,[e("span",{class:A(["px-2.5 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider",s.status==="active"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"])},d(s.status),3)]),e("td",de,[e("div",pe,[e("button",{onClick:$=>U(s),class:"p-2 text-blue-600 hover:bg-blue-50 rounded-md transition-colors"},[...t[13]||(t[13]=[e("i",{class:"pi pi-pencil"},null,-1)])],8,ue),e("button",{onClick:$=>S(s.id),class:"p-2 text-rose-600 hover:bg-rose-50 rounded-md transition-colors"},[...t[14]||(t[14]=[e("i",{class:"pi pi-trash"},null,-1)])],8,ce)])])]))),128))])])]),i(T,{pagination:r.pagination,onPageChange:c},null,8,["pagination"])])]),i(L,{modelValue:p.value,"onUpdate:modelValue":t[7]||(t[7]=s=>p.value=s),title:u.value?"Edit Customer Details":"Create New Customer",onSave:t[8]||(t[8]=s=>u.value?j():P()),disableSaveBtn:o.value},{default:O(()=>[e("div",xe,[e("div",me,[i(v,{label:"Customer Full Name",modelValue:a.name,"onUpdate:modelValue":t[1]||(t[1]=s=>a.name=s),error:n.name,placeholder:"Enter name"},null,8,["modelValue","error"])]),i(v,{label:"Phone Number (Primary)",modelValue:a.phone_one,"onUpdate:modelValue":t[2]||(t[2]=s=>a.phone_one=s),error:n.phone_one,placeholder:"03xx-xxxxxxx"},null,8,["modelValue","error"]),i(v,{label:"Phone Number (Secondary)",modelValue:a.phone_two,"onUpdate:modelValue":t[3]||(t[3]=s=>a.phone_two=s),error:n.phone_two,placeholder:"Optional"},null,8,["modelValue","error"]),i(v,{label:"NIC Number",modelValue:a.nic,"onUpdate:modelValue":t[4]||(t[4]=s=>a.nic=s),error:n.nic,placeholder:"42xxx-xxxxxxx-x"},null,8,["modelValue","error"]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-semibold text-slate-700 mb-1"},"Status",-1)),k(e("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>a.status=s),class:"w-full border-slate-300 rounded-lg text-sm focus:ring-blue-500 h-[42px]"},[...t[16]||(t[16]=[e("option",{value:"active"},"Active",-1),e("option",{value:"inactive"},"Inactive",-1)])],512),[[E,a.status]])]),e("div",fe,[t[18]||(t[18]=e("label",{class:"block text-sm font-semibold text-slate-700 mb-1"},"Residential Address",-1)),k(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=s=>a.address=s),rows:"3",class:"w-full border-slate-300 rounded-lg text-sm focus:ring-blue-500 p-3",placeholder:"Enter full address"},null,512),[[F,a.address]])])])]),_:1},8,["modelValue","title","disableSaveBtn"])]))}};export{Pe as default};
