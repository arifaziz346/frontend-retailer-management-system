import{a as u}from"./axios-DE8_S7fk.js";import{_ as T}from"./Pagination-DOnoG2pi.js";import{_ as C}from"./SelectOption-BIregkoR.js";import{_ as y}from"./FormInput-CF_-DtuM.js";import{_ as F}from"./BaseModal-DRbLze44.js";import{V as M}from"./vue-spinner-tail-C3An_VU4.js";import{t as h}from"./toast-kIWbnzaY.js";import{r as c,j as f,l as R,c as m,f as E,a as t,b as n,u as z,e as w,F as P,q as L,n as q,h as G,o as g,t as _}from"./index-VsIih__0.js";import{u as H}from"./useFormErrors-BWkWHfi_.js";import"./stringHelpers-DhATn_QK.js";import"./sweetalert2.esm.all-BQxta0Da.js";const I={key:0,class:"fixed inset-0 flex items-center justify-center bg-white/70 backdrop-blur-sm z-50"},J={class:"bg-gray-50 min-h-screen p-6"},K={class:"flex flex-wrap gap-4 mt-2 bg-white p-4 rounded-lg shadow items-end"},Q={class:"w-auto min-w-[150px]"},W={class:"mt-6 bg-white rounded-lg shadow overflow-x-auto"},X={class:"min-w-full text-sm divide-y divide-gray-200"},Y={class:"bg-white divide-y divide-gray-200"},Z={class:"px-4 py-3"},ee={class:"px-4 py-3"},te={class:"px-4 py-3"},se={class:"px-4 py-3"},ae={class:"px-4 py-3 flex flex-col sm:flex-row justify-center gap-2"},le=["onClick"],oe=["onClick"],ne={key:0},re={class:"mt-4"},ie={class:"space-y-4"},de={class:"flex items-end gap-2 w-full"},pe={class:"flex-1 min-w-[150px]"},ue={class:"mt-6"},ce=20,Ce={__name:"Expense",setup(me){const U=G(),r=c(!1),d=c(!1),x=c(!1),o=f({expenses:[],pagination:{currentPage:1,nextPageUrl:null,prevPageUrl:null,lastPage:1}}),V=c([]),v=c([]),b=f({expense_title:"",expense_category_id:""}),l=f({id:null,expense_title:"",expense_category_id:"",amount:"",expense_date:"",remark:""}),i=f({}),$=H(i),p=async(a=1)=>{r.value=!0;try{const e=await u.get("/expenses",{params:{page:a,per_page:ce,...b}});o.expenses=e.data.data,o.pagination.currentPage=e.data.meta.current_page,o.pagination.lastPage=e.data.meta.last_page,o.pagination.nextPageUrl=e.data.links.next,o.pagination.prevPageUrl=e.data.links.prev}finally{r.value=!1}},j=async()=>{const a=await u.get("/expense-categories");V.value=a.data.data,v.value=V.value.map(e=>({label:e.category_name,value:e.id}))},D=async()=>{r.value=!0;try{const a={...l};delete a.category,x.value?(await u.put(`/expenses/${l.id}`,a),h.success("Expense updated")):(await u.post("/expenses",a),h.success("Expense created")),p(),k()}catch(a){$(a)}finally{r.value=!1}},S=()=>{k(),d.value=!0},A=a=>{Object.assign(l,a),l.expense_category_id=a.category?.id??a.expense_category_id??null,x.value=!0,d.value=!0},B=async a=>{try{if(!confirm("Delete this expense?"))return;await u.delete(`/expenses/${a}`),h.success("Expense deleted"),p(o.pagination.currentPage)}catch{}finally{r.value=!1}},k=()=>{Object.keys(l).forEach(a=>l[a]=""),l.id=null,x.value=!1,d.value=!1,Object.keys(i).forEach(a=>delete i[a])},N=()=>{U.push("expense-category")};return R(()=>{p(1),j()}),(a,e)=>(g(),m(P,null,[r.value?(g(),m("div",I,[n(z(M),{size:"48px",color:"#2563eb"})])):E("",!0),t("div",J,[t("div",{class:"flex justify-between items-center bg-white p-4 rounded-lg shadow"},[e[10]||(e[10]=t("h2",{class:"text-xl font-bold text-gray-800"},[t("i",{class:"pi pi-tags text-blue-600"}),w(" Expenses")],-1)),t("button",{onClick:S,class:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow"},[...e[9]||(e[9]=[t("i",{class:"pi pi-plus"},null,-1),t("span",null,"Add Expense",-1)])])]),t("div",K,[t("div",Q,[n(C,{modelValue:b.expense_category_id,"onUpdate:modelValue":[e[0]||(e[0]=s=>b.expense_category_id=s),e[1]||(e[1]=s=>p(1))],list:v.value,label:"Category",placeholder:"All Categories"},null,8,["modelValue","list"])])]),t("div",W,[t("table",X,[e[14]||(e[14]=t("thead",{class:"bg-gray-100"},[t("tr",null,[t("th",{class:"px-4 py-3 text-left text-gray-700 font-medium"},"Title"),t("th",{class:"px-4 py-3 text-left text-gray-700 font-medium"},"Category"),t("th",{class:"px-4 py-3 text-left text-gray-700 font-medium"},"Amount"),t("th",{class:"px-4 py-3 text-left text-gray-700 font-medium"},"Date"),t("th",{class:"px-4 py-3 text-center text-gray-700 font-medium"},"Action")])],-1)),t("tbody",Y,[(g(!0),m(P,null,L(o.expenses,s=>(g(),m("tr",{key:s.id},[t("td",Z,_(s.expense_title),1),t("td",ee,_(s.category?.name||"-"),1),t("td",te,"Rs. "+_(s.amount),1),t("td",se,_(s.expense_date),1),t("td",ae,[t("button",{onClick:O=>A(s),class:"flex items-center gap-1 px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-md shadow text-xs"},[...e[11]||(e[11]=[t("i",{class:"pi pi-pencil"},null,-1),w(" Edit ",-1)])],8,le),t("button",{onClick:O=>B(s.id),class:"flex items-center gap-1 px-2 py-1 bg-red-500 hover:bg-red-600 text-white rounded-md shadow text-xs"},[...e[12]||(e[12]=[t("i",{class:"pi pi-trash"},null,-1),w(" Delete ",-1)])],8,oe)])]))),128)),o.expenses.length?E("",!0):(g(),m("tr",ne,[...e[13]||(e[13]=[t("td",{colspan:"5",class:"text-center py-6 text-gray-500"}," No expenses found ",-1)])]))])])]),t("div",re,[n(T,{pagination:o.pagination,onPageChange:p},null,8,["pagination"])]),n(F,{modelValue:d.value,"onUpdate:modelValue":e[8]||(e[8]=s=>d.value=s),title:x.value?"Edit Expense":"Create Expense",onSave:D,disableSaveBtn:r.value},{default:q(()=>[t("div",ie,[n(y,{label:"Title",modelValue:l.expense_title,"onUpdate:modelValue":e[2]||(e[2]=s=>l.expense_title=s),error:i.expense_title},null,8,["modelValue","error"]),n(y,{label:"Amount",type:"number",modelValue:l.amount,"onUpdate:modelValue":e[3]||(e[3]=s=>l.amount=s),error:i.amount},null,8,["modelValue","error"]),n(y,{label:"Date",type:"date",modelValue:l.expense_date,"onUpdate:modelValue":e[4]||(e[4]=s=>l.expense_date=s),error:i.expense_date},null,8,["modelValue","error"]),t("div",de,[t("div",pe,[n(C,{modelValue:l.expense_category_id,"onUpdate:modelValue":e[5]||(e[5]=s=>l.expense_category_id=s),list:v.value,label:"Category",placeholder:"Select Category",error:i.expense_category_id},null,8,["modelValue","list","error"])]),t("div",ue,[t("button",{class:"bg-green-600 hover:bg-green-700 text-white px-4 py-1.5 rounded-md shadow-sm border border-green-700",onClick:e[6]||(e[6]=s=>N())}," +Category ")])]),n(y,{label:"Remark",modelValue:l.remark,"onUpdate:modelValue":e[7]||(e[7]=s=>l.remark=s)},null,8,["modelValue"])])]),_:1},8,["modelValue","title","disableSaveBtn"])])],64))}};export{Ce as default};
