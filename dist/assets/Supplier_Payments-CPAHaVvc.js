import{a as g}from"./axios-pwxHYZIu.js";import{_ as T}from"./Button-D7xYEVP1.js";import{r as u,j as V,l as q,z as J,c as p,a as t,b as m,u as G,n as _,y as H,F as C,q as E,e as h,t as r,h as K,o as d,x as Q}from"./index-DppJ4uJc.js";import{V as W}from"./vue-spinner-tail-D8qEx31J.js";import{_ as X}from"./BaseModal-DaTHTPvo.js";import{_ as S}from"./FormInput-DqkHBGkx.js";import{_ as Y}from"./SelectOption-CNK7ar8U.js";import{_ as Z}from"./Pagination-hmH0ImhT.js";import{t as y}from"./toast-kIWbnzaY.js";import{u as ee}from"./useFormErrors-BWkWHfi_.js";import{u as te}from"./usePrint-CvHrX7Rc.js";import"./stringHelpers-DhATn_QK.js";import"./sweetalert2.esm.all-BQxta0Da.js";const se={key:0,class:"fixed inset-0 flex items-center justify-center bg-white/70 backdrop-blur-sm z-50"},ae={class:"flex flex-col items-center space-y-3"},le={key:1,class:"flex flex-col min-h-screen bg-gray-50 overflow-x-hidden"},oe={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between bg-white border-b border-gray-200 px-4 py-3 shadow-sm rounded-lg"},ne={class:"flex items-center space-x-2 text-sm md:text-base text-gray-600"},re=["onClick"],ie={class:"flex-1 p-4 sm:p-6 md:p-8"},de={class:"w-full bg flex flex-row items-center print:hidden bg-gray-800 text-white p-1.5 justify-between"},pe={class:"flex flex-row"},me={class:"w-full border border-gray-300 bg-gray-100 p-5 rounded-md"},ue={class:"flex justify-between w-full"},ce={class:"flex flex-col space-y-2"},ye={class:"flex items-center space-x-2"},fe={class:"font-medium text-gray-800"},xe={class:"font-normal"},ge={class:"flex items-center space-x-2"},be={class:"font-medium text-gray-800"},_e={class:"font-normal"},he={class:"flex items-center space-x-2"},ve={class:"font-medium text-gray-800"},we={class:"font-normal"},ke={class:"min-w-full border border-gray-200 bg-white rounded-xl overflow-hidden shadow-sm text-xs sm:text-sm md:text-base"},Pe={class:"px-4 py-2 font-medium text-gray-800"},Ve={class:"px-4 py-2 font-medium text-gray-900"},Ce={class:"px-4 py-2 text-gray-700"},Se={class:"px-4 py-2 text-gray-700"},Be={class:"px-4 py-2 text-gray-700"},Ue={class:"px-4 py-2 flex flex-col sm:flex-row justify-center gap-2 print:hidden"},$e=["onClick"],je=["onClick"],De={key:1,class:"flex flex-col items-center justify-center h-[60vh] text-center"},Ee={class:"bg-white p-4 rounded-lg shadow-2xl space-y-2"},Fe={class:"mb-4"},Le=20,Ne="/admin/Supplier",Re="Supplier",Ye={__name:"Supplier_Payments",setup(ze){const B=u(null),{printElement:F}=te(),U=J(),$=K(),o=V({payments:[],supplier:[],pagination:{currentPage:1,nextPageUrl:null,prevPageUrl:null,lastPage:1}}),j=["Easypaisa","JazzCash","Bank","Other"];u("");const i=u(!1),v=u(!1),f=u(!1),b=u(""),x=u(!1);u("");const l=V({id:"",supplier_id:"",amount:"",payment_method:"",payment_date:"",reference_number:"",remark:""}),c=V({amount:"",payment_method:"",payment_date:"",reference_number:"",remark:""}),L=ee(c),w=async(s="/supplier-payments")=>{try{v.value?v.value=!0:i.value=!0;const n=(await g.get(s)).data.data;o.payments=n.data||n,o.pagination.currentPage=n.current_page??1,o.pagination.lastPage=n.last_page??1,o.pagination.nextPageUrl=n.next_page_url??null,o.pagination.prevPageUrl=n.prev_page_url??null}catch(e){console.error("Error fetching payments:",e),y.error("Failed to fetch payments")}finally{i.value=!1,v.value=!1}},k=()=>{l.amount="",l.payment_date="",l.payment_method="",l.remark="",Object.keys(c).forEach(s=>c[s]=""),x.value=!1,f.value=!1,b.value=""},N=s=>{console.log("paymenet---",s),f.value=!0,l.id=s.id,b.value=s.id,l.supplier_id=s.supplier_id,l.amount=s.amount,l.payment_date=s.payment_date,l.remark=s.remark,l.payment_method=j.find(e=>e.toLowerCase()===s.payment_method?.toLowerCase()?.trim())||"Not found",x.value=!0},R=async()=>{i.value=!0;try{let s;if(f.value){s=await g.put(`/supplier-payments/${b.value}`,l);const e=s.data.data??s.data.payment??s.data,n=o.payments.findIndex(a=>a.id===b.value);n!==-1&&(o.payments[n]=e),y.success(s.data.message||"Payment updated successfully"),k()}else{s=await g.post("/supplier-payments",l);const e=s.data.data??s.data.payment??s.data;o.payments.unshift(e),y.success(s.data.message||"Payment created successfully"),k()}}catch(s){console.error("Error saving/updating payment:",s),L(s)}finally{i.value=!1}},z=async s=>{if(confirm("Are you sure you want to delete this payment?")){i.value=!0;try{const e=await g.delete(`/supplier-payments/${s}`);e.data.success&&(w(),y.success(e.data.message||"Payment deleted successfully"))}catch(e){console.error("Error deleting payment:",e),y.error("Failed to delete payment")}finally{i.value=!1}}},A=[{label:"Supplier-Detail",isBack:!0,fallback:"/admin/Payment"},{label:"Supplier Payments",isBack:!1,route:"#"}],M=async s=>{i.value=!0;try{const e=await g.get(`suppliers/${s}`);o.supplier=e.data.data}catch(e){y.error(e)}finally{i.value=!1}},O=s=>{window.history.length>1?$.back():$.push(s)},I=()=>{F(B)};return q(async()=>{l.supplier_id=U.params?.supplier_id,await M(U.params?.supplier_id),await w()}),(s,e)=>{const n=H("router-link");return i.value?(d(),p("div",se,[t("div",ae,[m(G(W),{size:"48px",color:"#2563eb"}),e[7]||(e[7]=t("p",{class:"text-blue-600 text-sm font-medium animate-pulse"}," Loading, please wait... ",-1))])])):(d(),p("div",le,[t("header",oe,[t("nav",ne,[m(n,{to:Ne,class:"flex items-center hover:text-blue-600 transition-colors"},{default:_(()=>[e[8]||(e[8]=t("i",{class:"pi pi-home mr-1 text-2xl"},null,-1)),t("span",{class:"sm:inline"},r(Re))]),_:1}),(d(),p(C,null,E(A,(a,P)=>(d(),p(C,{key:P},[e[9]||(e[9]=t("i",{class:"pi pi-chevron-right text-gray-400 mx-0.5"},null,-1)),a.isBack?(d(),p("button",{key:0,onClick:D=>O(a.fallback),class:"sm:inline text-gray-600 hover:text-blue-600"},r(a.label),9,re)):(d(),Q(n,{key:1,to:a.route,class:"sm:inline font-bold text-gray-600 hover:text-gray-800"},{default:_(()=>[h(r(a.label),1)]),_:2},1032,["to"]))],64))),64))])]),t("main",ie,[o.payments&&o.payments.length?(d(),p("div",{key:0,ref_key:"invoiceRef",ref:B,class:"w-full overflow-x-scroll border border-gray-300 rounded-md shadow-sm"},[t("div",de,[e[12]||(e[12]=t("i",{class:"pi pi-money-bill mr-1 text-lg"}," Payment List",-1)),t("div",pe,[t("button",{onClick:I,class:"relative text-white rounded mr-3 p-2 group"},[...e[10]||(e[10]=[t("i",{class:"pi pi-print text-white text-lg transition-transform duration-200 group-hover:scale-110"},null,-1),t("span",{class:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 bg-gray-800 text-white text-xs rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 whitespace-nowrap"}," Click to Print ",-1)])]),m(T,{variant:"primary",size:"sm",class:"flex items-center justify-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg shadow-sm transition-all duration-150 mt-3 sm:mt-0",onClick:e[0]||(e[0]=()=>{k(),f.value=!1,x.value=!0})},{default:_(()=>[...e[11]||(e[11]=[t("i",{class:"pi pi-plus text-sm"},null,-1),t("span",null,"Payment",-1)])]),_:1})])]),e[22]||(e[22]=t("div",{class:"hidden print:flex w-full h-16 items-center justify-center text-2xl font-bold border-t border-b border-gray-400 bg-gray-100 space-x-2"},[t("i",{class:"pi pi-money-bill text-3xl"}),t("span",null,"Supplier Paid Details")],-1)),t("div",me,[t("div",ue,[t("div",ce,[t("div",ye,[e[14]||(e[14]=t("i",{class:"pi pi-user text-gray-700"},null,-1)),t("span",fe,[e[13]||(e[13]=h(" Supplier Name: ",-1)),t("span",xe,r(o.supplier?.name||"-"),1)])]),t("div",ge,[e[16]||(e[16]=t("i",{class:"pi pi-phone text-gray-700"},null,-1)),t("span",be,[e[15]||(e[15]=h(" Contact No: ",-1)),t("span",_e,r(o.supplier?.contact_person||"-"),1)])]),t("div",he,[e[18]||(e[18]=t("i",{class:"pi pi-map-marker text-gray-700"},null,-1)),t("span",ve,[e[17]||(e[17]=h(" Address: ",-1)),t("span",we,r(o.supplier?.address||"-"),1)])])])])]),t("table",ke,[e[21]||(e[21]=t("thead",{class:"bg-gray-100 text-gray-700 text-xs"},[t("tr",null,[t("th",{class:"px-4 py-2 text-left font-semibold"},"#"),t("th",{class:"px-4 py-2 text-left font-semibold"},"Amount"),t("th",{class:"px-4 py-2 text-left font-semibold"},"Payment-Method"),t("th",{class:"px-4 py-2 text-left font-semibold"},"Payment-Date"),t("th",{class:"px-4 py-2 text-left font-semibold"},"Remarks"),t("th",{class:"px-4 py-2 text-center font-semibold print:hidden"},"Action")])],-1)),t("tbody",null,[(d(!0),p(C,null,E(o.payments,(a,P)=>(d(),p("tr",{key:a.id,class:"border-t border-t-gray-300 hover:bg-gray-50 transition ext-sm text-xs"},[t("td",Pe,r(P+1+(o.pagination.currentPage-1)*Le),1),t("td",Ve,"Rs."+r(a.amount),1),t("td",Ce,r(a.payment_method||"-"),1),t("td",Se,r(a.payment_date||"-"),1),t("td",Be,r(a.remark),1),t("td",Ue,[t("button",{onClick:D=>N(a),class:"flex flex-col sm:flex-row items-center gap-1 p-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md shadow text-xs"},[...e[19]||(e[19]=[t("i",{class:"pi pi-pencil text-base"},null,-1),t("span",null,"Edit",-1)])],8,$e),t("button",{onClick:D=>z(a.id),class:"flex flex-col sm:flex-row items-center gap-1 p-2 bg-red-500 hover:bg-red-600 text-white rounded-md shadow text-xs"},[...e[20]||(e[20]=[t("i",{class:"pi pi-trash text-base"},null,-1),t("span",null,"Delete",-1)])],8,je)])]))),128))])]),m(Z,{pagination:o.pagination,onPageChange:w},null,8,["pagination"])],512)):(d(),p("div",De,[...e[23]||(e[23]=[t("img",{src:"https://cdn-icons-png.flaticon.com/512/4076/4076549.png",alt:"No Data",class:"w-32 h-32 opacity-70 mb-4"},null,-1),t("h2",{class:"text-xl font-semibold text-gray-700 mb-2"},"No Payments Found",-1),t("p",{class:"text-gray-500"}," Try adding new payments to see them listed here. ",-1)])]))]),m(X,{modelValue:x.value,"onUpdate:modelValue":e[5]||(e[5]=a=>x.value=a),title:f.value?"Update Payment":"Create Payment",onSave:e[6]||(e[6]=()=>R()),disableSaveBtn:i.value},{default:_(()=>[t("div",Ee,[m(S,{id:"amount",type:"number",label:"Amount",modelValue:l.amount,"onUpdate:modelValue":e[1]||(e[1]=a=>l.amount=a),error:c.amount},null,8,["modelValue","error"]),t("div",Fe,[m(Y,{modelValue:l.payment_method,"onUpdate:modelValue":e[2]||(e[2]=a=>l.payment_method=a),list:j,label:"Payment Method",placeholder:"Select Payment Method",error:c.payment_method},null,8,["modelValue","error"])]),m(S,{id:"payment_date",label:"Payment-Date",type:"date",modelValue:l.payment_date,"onUpdate:modelValue":e[3]||(e[3]=a=>l.payment_date=a),error:c.payment_date},null,8,["modelValue","error"]),m(S,{id:"remark",label:"Remarks",modelValue:l.remark,"onUpdate:modelValue":e[4]||(e[4]=a=>l.remark=a),error:c.remark},null,8,["modelValue","error"])])]),_:1},8,["modelValue","title","disableSaveBtn"])]))}}};export{Ye as default};
